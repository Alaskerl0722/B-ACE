{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1769073136150836, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.03589644195089932, "policy_loss": 0.0005599232856184245, "vf_loss": 0.490585807338357, "vf_explained_var": -0.02058250457048416, "kl": 0.004771789614460431, "entropy": 1.6005716979503632, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 40.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1332522720098495, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.04516286688740365, "policy_loss": -0.0011304467916488647, "vf_loss": 0.46105639934539794, "vf_explained_var": 0.02243747189640999, "kl": 0.004346716549480334, "entropy": 1.6016585767269134, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 40.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8410749465227128, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.02996917909185868, "policy_loss": 0.0002428197884000838, "vf_loss": 0.5209467831999064, "vf_explained_var": -0.0503555677831173, "kl": 0.001652905877563171, "entropy": 1.607792729139328, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 40.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.129835233837366, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.05047093232133193, "policy_loss": 0.0005120238289237023, "vf_loss": 0.43438059091567993, "vf_explained_var": -0.23204864114522933, "kl": 0.005255050968844444, "entropy": 1.6062911003828049, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 40.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2111751027405262, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.06863779438717757, "policy_loss": -0.0012172175454907119, "vf_loss": 0.3706319913268089, "vf_explained_var": -0.07874509915709496, "kl": 0.0020444161986233667, "entropy": 1.6048745661973953, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 40.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2988953486084938, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.06818731947860215, "policy_loss": -0.004188406234607101, "vf_loss": 0.3769563306123018, "vf_explained_var": -0.5215602993965149, "kl": 0.010208252002485096, "entropy": 1.6027964279055595, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 40.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1743342287838459, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.03564319586148486, "policy_loss": 0.0034670351771637796, "vf_loss": 0.4831559848040342, "vf_explained_var": -0.16944458186626435, "kl": 0.004086406534770504, "entropy": 1.6071650385856628, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 40.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.188156395405531, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.028693207641481422, "policy_loss": 0.0011856201570481062, "vf_loss": 0.5164693586528302, "vf_explained_var": -0.1965395137667656, "kl": 0.0032384865218773482, "entropy": 1.59643861502409, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 40.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096, "num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 37.99821722862374, "num_env_steps_trained_throughput_per_sec": 37.99821722862374, "timesteps_total": 512, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 4096, "timers": {"training_iteration_time_ms": 13474.272, "sample_time_ms": 4151.576, "learn_time_ms": 9306.416, "learn_throughput": 55.016, "synch_weights_time_ms": 13.975}, "counters": {"num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-09-57", "timestamp": 1708024197, "time_this_iter_s": 13.485575914382935, "time_total_s": 13.485575914382935, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f8588731240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 13.485575914382935, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 18.119999999999997, "ram_util_percent": 47.495000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1700499013066292, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 2e-05, "total_loss": -0.083066076374962, "policy_loss": -0.00036448929458856585, "vf_loss": 0.30687601007521154, "vf_explained_var": 0.06400581076741219, "kl": 0.004498304170556367, "entropy": 1.5987041562795639, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.107639990001917, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 2e-05, "total_loss": -0.07375441834446975, "policy_loss": -0.004520919919013977, "vf_loss": 0.3626087687909603, "vf_explained_var": -0.053850510716438295, "kl": 0.004417156588169746, "entropy": 1.6032740488648414, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0209090568125248, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 2e-05, "total_loss": -0.07128565223974874, "policy_loss": -0.004396775970235467, "vf_loss": 0.3748544190078974, "vf_explained_var": -0.08035578429698945, "kl": 0.0019751553380046973, "entropy": 1.607999937236309, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9766742691397667, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.11072251515870449, "policy_loss": -0.01144970313180238, "vf_loss": 0.24122164025902748, "vf_explained_var": -0.17196147963404657, "kl": 0.0052092253288719805, "entropy": 1.606200608611107, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1047508873045444, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 2e-05, "total_loss": -0.07535867593542207, "policy_loss": -0.003002709872089326, "vf_loss": 0.35228354167193177, "vf_explained_var": -0.39458111822605135, "kl": 0.0018939212735858747, "entropy": 1.6061624214053154, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2186854213476181, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.10695767704892205, "policy_loss": 0.0008820024086162448, "vf_loss": 0.19799923254176974, "vf_explained_var": -0.6142134055495262, "kl": 0.008738103922223673, "entropy": 1.5908710405230522, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1709004506468772, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 2e-05, "total_loss": -0.0628667047538329, "policy_loss": -0.006953995302319526, "vf_loss": 0.41690034307539464, "vf_explained_var": -0.571802145242691, "kl": 0.005102753479150124, "entropy": 1.606480684876442, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0747232273221017, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 2e-05, "total_loss": -0.056362398515921085, "policy_loss": -0.009645416564308108, "vf_loss": 0.45220030285418034, "vf_explained_var": -0.09953010603785514, "kl": 0.0035049603757215664, "entropy": 1.6011754989624023, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 39.41914892023567, "num_env_steps_trained_throughput_per_sec": 39.41914892023567, "timesteps_total": 1024, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 8192, "timers": {"training_iteration_time_ms": 13231.423, "sample_time_ms": 4065.216, "learn_time_ms": 9149.564, "learn_throughput": 55.959, "synch_weights_time_ms": 14.769}, "counters": {"num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-10-10", "timestamp": 1708024210, "time_this_iter_s": 13.000463008880615, "time_total_s": 26.48603892326355, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f8588730ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 26.48603892326355, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.827777777777776, "ram_util_percent": 48.37222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0549089044332505, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": -0.09547277719539124, "policy_loss": -0.0036641692044213415, "vf_loss": 0.27277373652905224, "vf_explained_var": -0.5631386369466782, "kl": 0.006349631305783987, "entropy": 1.603195221722126, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 200.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1601144544780255, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": -0.08594409504003124, "policy_loss": 0.004350799776148051, "vf_loss": 0.2795016114600003, "vf_explained_var": -0.26440837010741236, "kl": 0.004209899369743653, "entropy": 1.6038078874349595, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 200.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1349167712032795, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": -0.0732571527318214, "policy_loss": -8.843094110488892e-05, "vf_loss": 0.34972366970032454, "vf_explained_var": -0.28549559935927393, "kl": 0.0016165956214535982, "entropy": 1.606804656982422, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 200.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2464699484407902, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.07546603654045611, "policy_loss": -0.010193916317075492, "vf_loss": 0.3775003869086504, "vf_explained_var": -0.233765334635973, "kl": 0.004566156808868982, "entropy": 1.6056044295430183, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 200.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1688277810811996, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": -0.11825945624732412, "policy_loss": -0.005599352670833469, "vf_loss": 0.19024575692601503, "vf_explained_var": -0.04952995702624321, "kl": 0.00220399154786719, "entropy": 1.6033173725008965, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 200.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3802090898156165, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.08899180068692658, "policy_loss": -0.0056880946503952146, "vf_loss": 0.29836037224158646, "vf_explained_var": -0.8255729079246521, "kl": 0.010016328829806298, "entropy": 1.5989706084132194, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 200.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3206159994006157, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 2e-05, "total_loss": -0.033552980251261036, "policy_loss": -0.007412838435266167, "vf_loss": 0.5350905995815992, "vf_explained_var": -0.05425517410039902, "kl": 0.0057045295368880035, "entropy": 1.6048324137926102, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 200.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2225188054144382, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": -0.0557642469444545, "policy_loss": 0.0015414820984005928, "vf_loss": 0.41128999572247266, "vf_explained_var": -0.10564535856246948, "kl": 0.005070161214098335, "entropy": 1.6038173258304596, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 200.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288, "num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 39.971414832271876, "num_env_steps_trained_throughput_per_sec": 39.971414832271876, "timesteps_total": 1536, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 12288, "timers": {"training_iteration_time_ms": 13090.653, "sample_time_ms": 4022.965, "learn_time_ms": 9050.445, "learn_throughput": 56.572, "synch_weights_time_ms": 15.5}, "counters": {"num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-10-23", "timestamp": 1708024223, "time_this_iter_s": 12.816978216171265, "time_total_s": 39.303017139434814, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f8588732290>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 39.303017139434814, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 17.88421052631579, "ram_util_percent": 48.36315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0979759782552718, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": -0.0975795237784041, "policy_loss": -0.0030460306908935307, "vf_loss": 0.262581717595458, "vf_explained_var": -0.010437984764575959, "kl": 0.0033230985893169416, "entropy": 1.6034507498145103, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 280.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0453686390072108, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 2e-05, "total_loss": -0.1220123373757815, "policy_loss": -0.013006873265840112, "vf_loss": 0.2041664170101285, "vf_explained_var": -0.16765854880213737, "kl": 0.004579456296050921, "entropy": 1.601615533232689, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 280.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.098511953651905, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 2e-05, "total_loss": -0.10835303558269516, "policy_loss": -0.008920638472773135, "vf_loss": 0.24478434063494206, "vf_explained_var": -0.16410816386342048, "kl": 0.002042055934725795, "entropy": 1.6067953169345857, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 280.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1040234416723251, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 2e-05, "total_loss": -0.10320584800974757, "policy_loss": -0.003853489551693201, "vf_loss": 0.24395153652876617, "vf_explained_var": -0.11550936922430992, "kl": 0.0026738859422039242, "entropy": 1.6060762852430344, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 280.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.187498888000846, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 2e-05, "total_loss": -0.07573797377990558, "policy_loss": -0.005120633274782449, "vf_loss": 0.35869427397847176, "vf_explained_var": -0.4503327265381813, "kl": 0.0031753849470987916, "entropy": 1.6037029325962067, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 280.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.113583992421627, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.10223563317558729, "policy_loss": -0.0032583971275016665, "vf_loss": 0.24079737085849046, "vf_explained_var": -0.4888836607336998, "kl": 0.005784254550235346, "entropy": 1.6033343002200127, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 280.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.242233794927597, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 2e-05, "total_loss": -0.094412303250283, "policy_loss": -0.0015018799342215062, "vf_loss": 0.26866222377866505, "vf_explained_var": -0.3818310767412186, "kl": 0.004788615691359155, "entropy": 1.6055483609437942, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 280.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1581178463995456, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": -0.048342122725443915, "policy_loss": 0.0018487959867343306, "vf_loss": 0.4389475015923381, "vf_explained_var": -0.8149975508451461, "kl": 0.0034017615660559388, "entropy": 1.6009787887334823, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 280.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "sampler_results": {"episode_reward_max": -342.4874999999977, "episode_reward_min": -376.7199999999975, "episode_reward_mean": -361.7990624999981, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"pursuer_0": -47.09000000000001, "pursuer_1": -47.09000000000001, "pursuer_2": -47.09000000000001, "pursuer_3": -47.09000000000001, "pursuer_4": -47.09000000000001, "pursuer_5": -47.09000000000001, "pursuer_6": -47.09000000000001, "pursuer_7": -47.09000000000001}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.22488281250001, "pursuer_1": -45.22488281250001, "pursuer_2": -45.22488281250001, "pursuer_3": -45.22488281250001, "pursuer_4": -45.22488281250001, "pursuer_5": -45.22488281250001, "pursuer_6": -45.22488281250001, "pursuer_7": -45.22488281250001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987], "episode_lengths": [500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.492489638151946, "mean_inference_ms": 15.768584452177349, "mean_action_processing_ms": 1.0277554538050127, "mean_env_wait_ms": 10.61822947470533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009341537952423096, "StateBufferConnector_ms": 0.004222989082336426, "ViewRequirementAgentConnector_ms": 0.11031851172447205}}, "episode_reward_max": -342.4874999999977, "episode_reward_min": -376.7199999999975, "episode_reward_mean": -361.7990624999981, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"pursuer_0": -47.09000000000001, "pursuer_1": -47.09000000000001, "pursuer_2": -47.09000000000001, "pursuer_3": -47.09000000000001, "pursuer_4": -47.09000000000001, "pursuer_5": -47.09000000000001, "pursuer_6": -47.09000000000001, "pursuer_7": -47.09000000000001}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.22488281250001, "pursuer_1": -45.22488281250001, "pursuer_2": -45.22488281250001, "pursuer_3": -45.22488281250001, "pursuer_4": -45.22488281250001, "pursuer_5": -45.22488281250001, "pursuer_6": -45.22488281250001, "pursuer_7": -45.22488281250001}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987], "episode_lengths": [500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.492489638151946, "mean_inference_ms": 15.768584452177349, "mean_action_processing_ms": 1.0277554538050127, "mean_env_wait_ms": 10.61822947470533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009341537952423096, "StateBufferConnector_ms": 0.004222989082336426, "ViewRequirementAgentConnector_ms": 0.11031851172447205}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 43.287761633173105, "num_env_steps_trained_throughput_per_sec": 43.287761633173105, "timesteps_total": 2048, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 16384, "timers": {"training_iteration_time_ms": 12774.936, "sample_time_ms": 3958.42, "learn_time_ms": 8798.625, "learn_throughput": 58.191, "synch_weights_time_ms": 16.243}, "counters": {"num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "done": false, "episodes_total": 4, "training_iteration": 4, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-10-35", "timestamp": 1708024235, "time_this_iter_s": 11.837763786315918, "time_total_s": 51.14078092575073, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f8588731510>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 51.14078092575073, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.7, "ram_util_percent": 48.21176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3900973953306675, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 2e-05, "total_loss": -0.09127807202748954, "policy_loss": -0.019316842197440565, "vf_loss": 0.35373588958755137, "vf_explained_var": -0.40499633103609084, "kl": 0.005739009071839973, "entropy": 1.605386745929718, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 360.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2835283409804106, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 2e-05, "total_loss": -0.09069297042733523, "policy_loss": 0.002048003033269197, "vf_loss": 0.2703530974686146, "vf_explained_var": 0.26601404696702957, "kl": 0.0037010825151810424, "entropy": 1.6037551030516624, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 360.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9863610289990902, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 2e-05, "total_loss": -0.11044605836214032, "policy_loss": -0.008611851511523128, "vf_loss": 0.23521299017593264, "vf_explained_var": -0.9930622681975365, "kl": 0.0018482049752492457, "entropy": 1.6066055461764335, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 360.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1622423745691777, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": -0.09972300674417056, "policy_loss": -0.0061518363654613495, "vf_loss": 0.2669791161082685, "vf_explained_var": -0.9885151341557503, "kl": 0.0032128306629601866, "entropy": 1.6047658950090409, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 360.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0661711782217025, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 2e-05, "total_loss": -0.11386775989085436, "policy_loss": -0.005999398045241832, "vf_loss": 0.2099022652953863, "vf_explained_var": -0.093876663595438, "kl": 0.003279272315558046, "entropy": 1.6038491562008859, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 360.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8770969629287719, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.13043023376958446, "policy_loss": -0.0042832824983634055, "vf_loss": 0.1303958620876074, "vf_explained_var": 0.22414152324199677, "kl": 0.007699362392304465, "entropy": 1.6028578922152519, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 360.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6291086018085479, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": -0.06073404265443969, "policy_loss": -0.007610643096268177, "vf_loss": 0.427655422501266, "vf_explained_var": 0.07386618554592132, "kl": 0.005636846437118948, "entropy": 1.6031909704208374, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 360.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5880081802606583, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 2e-05, "total_loss": -0.02377046866749879, "policy_loss": -0.011396536021493375, "vf_loss": 0.5923359204083681, "vf_explained_var": -0.30758309587836263, "kl": 0.0046472966903820636, "entropy": 1.6057409256696702, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 360.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480}, "sampler_results": {"episode_reward_max": -342.4874999999977, "episode_reward_min": -376.7199999999975, "episode_reward_mean": -361.7990624999981, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.09000000000001, "pursuer_1": -47.09000000000001, "pursuer_2": -47.09000000000001, "pursuer_3": -47.09000000000001, "pursuer_4": -47.09000000000001, "pursuer_5": -47.09000000000001, "pursuer_6": -47.09000000000001, "pursuer_7": -47.09000000000001}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.22488281250001, "pursuer_1": -45.22488281250001, "pursuer_2": -45.22488281250001, "pursuer_3": -45.22488281250001, "pursuer_4": -45.22488281250001, "pursuer_5": -45.22488281250001, "pursuer_6": -45.22488281250001, "pursuer_7": -45.22488281250001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987], "episode_lengths": [500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.492489638151946, "mean_inference_ms": 15.768584452177349, "mean_action_processing_ms": 1.0277554538050127, "mean_env_wait_ms": 10.61822947470533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009341537952423096, "StateBufferConnector_ms": 0.004222989082336426, "ViewRequirementAgentConnector_ms": 0.11031851172447205}}, "episode_reward_max": -342.4874999999977, "episode_reward_min": -376.7199999999975, "episode_reward_mean": -361.7990624999981, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.09000000000001, "pursuer_1": -47.09000000000001, "pursuer_2": -47.09000000000001, "pursuer_3": -47.09000000000001, "pursuer_4": -47.09000000000001, "pursuer_5": -47.09000000000001, "pursuer_6": -47.09000000000001, "pursuer_7": -47.09000000000001}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.22488281250001, "pursuer_1": -45.22488281250001, "pursuer_2": -45.22488281250001, "pursuer_3": -45.22488281250001, "pursuer_4": -45.22488281250001, "pursuer_5": -45.22488281250001, "pursuer_6": -45.22488281250001, "pursuer_7": -45.22488281250001}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987], "episode_lengths": [500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.492489638151946, "mean_inference_ms": 15.768584452177349, "mean_action_processing_ms": 1.0277554538050127, "mean_env_wait_ms": 10.61822947470533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009341537952423096, "StateBufferConnector_ms": 0.004222989082336426, "ViewRequirementAgentConnector_ms": 0.11031851172447205}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480, "num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 43.03920483546693, "num_env_steps_trained_throughput_per_sec": 43.03920483546693, "timesteps_total": 2560, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 20480, "timers": {"training_iteration_time_ms": 12599.169, "sample_time_ms": 3947.057, "learn_time_ms": 8634.52, "learn_throughput": 59.297, "synch_weights_time_ms": 16.03}, "counters": {"num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480}, "done": false, "episodes_total": 4, "training_iteration": 5, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-10-47", "timestamp": 1708024247, "time_this_iter_s": 11.907792806625366, "time_total_s": 63.0485737323761, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f8588732320>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 63.0485737323761, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.076470588235296, "ram_util_percent": 48.3764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0467837475240231, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 2e-05, "total_loss": -0.07783976092541707, "policy_loss": 0.002206122037023306, "vf_loss": 0.32226514127105477, "vf_explained_var": -1.0, "kl": 0.003416191093856469, "entropy": 1.606975717842579, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 440.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0805406741797925, "cur_kl_coeff": 0.0062499999999999995, "cur_lr": 2e-05, "total_loss": -0.10639426998404815, "policy_loss": -0.005518047581426799, "vf_loss": 0.23628883473575116, "vf_explained_var": -0.9935674995183945, "kl": 0.004019689647248015, "entropy": 1.5997354909777641, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 440.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5712406396865846, "cur_kl_coeff": 0.0062499999999999995, "cur_lr": 2e-05, "total_loss": -0.002567292255844222, "policy_loss": -0.0010782353347167373, "vf_loss": 0.6370963752269745, "vf_explained_var": -0.9140714406967163, "kl": 0.001640714790846687, "entropy": 1.6077340483665465, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 440.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6911962021142244, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 2e-05, "total_loss": -0.13626820363515435, "policy_loss": -0.0016219765413552523, "vf_loss": 0.10301380562596023, "vf_explained_var": 0.0495175302028656, "kl": 0.003625800283043645, "entropy": 1.6049031853675841, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 440.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.145527221262455, "cur_kl_coeff": 0.0062499999999999995, "cur_lr": 2e-05, "total_loss": -0.06842475047888001, "policy_loss": -0.011325199855491519, "vf_loss": 0.411881185695529, "vf_explained_var": -0.7986836344003677, "kl": 0.0035985894850455225, "entropy": 1.600923316180706, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 440.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5710807234048842, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.04615608585299924, "policy_loss": -0.0045888436725363135, "vf_loss": 0.4695507114753127, "vf_explained_var": -0.2740546457469463, "kl": 0.006348161958158016, "entropy": 1.6022454887628554, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 440.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8568289946764708, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": -0.10147250451846049, "policy_loss": 0.0007999148452654481, "vf_loss": 0.2306328290142119, "vf_explained_var": -0.9973740741610527, "kl": 0.00675909262499772, "entropy": 1.6026857957243918, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 440.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8677953198552132, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 2e-05, "total_loss": -0.12053341044811532, "policy_loss": -0.011693657678551971, "vf_loss": 0.20262583270668982, "vf_explained_var": -0.5803199514746666, "kl": 0.005843006481882185, "entropy": 1.5956924453377723, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 440.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "sampler_results": {"episode_reward_max": -342.4874999999977, "episode_reward_min": -376.7199999999975, "episode_reward_mean": -361.7990624999981, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.09000000000001, "pursuer_1": -47.09000000000001, "pursuer_2": -47.09000000000001, "pursuer_3": -47.09000000000001, "pursuer_4": -47.09000000000001, "pursuer_5": -47.09000000000001, "pursuer_6": -47.09000000000001, "pursuer_7": -47.09000000000001}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.22488281250001, "pursuer_1": -45.22488281250001, "pursuer_2": -45.22488281250001, "pursuer_3": -45.22488281250001, "pursuer_4": -45.22488281250001, "pursuer_5": -45.22488281250001, "pursuer_6": -45.22488281250001, "pursuer_7": -45.22488281250001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987], "episode_lengths": [500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.492489638151946, "mean_inference_ms": 15.768584452177349, "mean_action_processing_ms": 1.0277554538050127, "mean_env_wait_ms": 10.61822947470533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009341537952423096, "StateBufferConnector_ms": 0.004222989082336426, "ViewRequirementAgentConnector_ms": 0.11031851172447205}}, "episode_reward_max": -342.4874999999977, "episode_reward_min": -376.7199999999975, "episode_reward_mean": -361.7990624999981, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.09000000000001, "pursuer_1": -47.09000000000001, "pursuer_2": -47.09000000000001, "pursuer_3": -47.09000000000001, "pursuer_4": -47.09000000000001, "pursuer_5": -47.09000000000001, "pursuer_6": -47.09000000000001, "pursuer_7": -47.09000000000001}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.22488281250001, "pursuer_1": -45.22488281250001, "pursuer_2": -45.22488281250001, "pursuer_3": -45.22488281250001, "pursuer_4": -45.22488281250001, "pursuer_5": -45.22488281250001, "pursuer_6": -45.22488281250001, "pursuer_7": -45.22488281250001}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987], "episode_lengths": [500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.492489638151946, "mean_inference_ms": 15.768584452177349, "mean_action_processing_ms": 1.0277554538050127, "mean_env_wait_ms": 10.61822947470533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009341537952423096, "StateBufferConnector_ms": 0.004222989082336426, "ViewRequirementAgentConnector_ms": 0.11031851172447205}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 39.59542493552811, "num_env_steps_trained_throughput_per_sec": 39.59542493552811, "timesteps_total": 3072, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 24576, "timers": {"training_iteration_time_ms": 12654.432, "sample_time_ms": 3935.717, "learn_time_ms": 8701.42, "learn_throughput": 58.841, "synch_weights_time_ms": 15.764}, "counters": {"num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "done": false, "episodes_total": 4, "training_iteration": 6, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-11-00", "timestamp": 1708024260, "time_this_iter_s": 12.940560102462769, "time_total_s": 75.98913383483887, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f85888101f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 75.98913383483887, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.194444444444446, "ram_util_percent": 48.388888888888886}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8754694797098637, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 2e-05, "total_loss": -0.12307048433867748, "policy_loss": -0.00017648150678724052, "vf_loss": 0.15095106586813928, "vf_explained_var": -0.8602584213018417, "kl": 0.00421789231186267, "entropy": 1.6068448930978776, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 520.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7401874154806137, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 2e-05, "total_loss": -0.13372422940446996, "policy_loss": -0.01228043008595705, "vf_loss": 0.15429448429495096, "vf_explained_var": -0.6442592158913613, "kl": 0.0039232429175172, "entropy": 1.6002967834472657, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 520.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9826135531067848, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 2e-05, "total_loss": -0.11237287833937444, "policy_loss": -0.0031225058250129224, "vf_loss": 0.20560251623392106, "vf_explained_var": -0.3667678162455559, "kl": 0.0027143601037096232, "entropy": 1.6065948158502579, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 520.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1448088973760604, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 2e-05, "total_loss": -0.08074704203936563, "policy_loss": -0.013867158349603415, "vf_loss": 0.3754635665565729, "vf_explained_var": -0.9038845270872116, "kl": 0.005557423731079325, "entropy": 1.6081523954868318, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 520.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0040687020868062, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 2e-05, "total_loss": -0.12574247251613996, "policy_loss": -0.009591430029831826, "vf_loss": 0.17489123372361065, "vf_explained_var": -0.1563050277531147, "kl": 0.004516192513983696, "entropy": 1.5988795906305313, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 520.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4673093020915986, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.08187508152332157, "policy_loss": -0.00974281842354685, "vf_loss": 0.3435610070824623, "vf_explained_var": -0.3977035365998745, "kl": 0.008992528478847817, "entropy": 1.598210170865059, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 520.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1301935315132141, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": -0.12255132896534633, "policy_loss": -0.0024992877384647726, "vf_loss": 0.16132674124091864, "vf_explained_var": 0.29960536286234857, "kl": 0.006090600625611842, "entropy": 1.6068825826048851, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 520.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.118357540667057, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 2e-05, "total_loss": -0.11696529444598128, "policy_loss": -0.004128662822768092, "vf_loss": 0.1869987655431032, "vf_explained_var": 0.19757676646113395, "kl": 0.00349356341175735, "entropy": 1.59629987180233, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 520.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672}, "sampler_results": {"episode_reward_max": -342.4874999999977, "episode_reward_min": -376.7199999999975, "episode_reward_mean": -361.7990624999981, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.09000000000001, "pursuer_1": -47.09000000000001, "pursuer_2": -47.09000000000001, "pursuer_3": -47.09000000000001, "pursuer_4": -47.09000000000001, "pursuer_5": -47.09000000000001, "pursuer_6": -47.09000000000001, "pursuer_7": -47.09000000000001}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.22488281250001, "pursuer_1": -45.22488281250001, "pursuer_2": -45.22488281250001, "pursuer_3": -45.22488281250001, "pursuer_4": -45.22488281250001, "pursuer_5": -45.22488281250001, "pursuer_6": -45.22488281250001, "pursuer_7": -45.22488281250001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987], "episode_lengths": [500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.492489638151946, "mean_inference_ms": 15.768584452177349, "mean_action_processing_ms": 1.0277554538050127, "mean_env_wait_ms": 10.61822947470533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009341537952423096, "StateBufferConnector_ms": 0.004222989082336426, "ViewRequirementAgentConnector_ms": 0.11031851172447205}}, "episode_reward_max": -342.4874999999977, "episode_reward_min": -376.7199999999975, "episode_reward_mean": -361.7990624999981, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.09000000000001, "pursuer_1": -47.09000000000001, "pursuer_2": -47.09000000000001, "pursuer_3": -47.09000000000001, "pursuer_4": -47.09000000000001, "pursuer_5": -47.09000000000001, "pursuer_6": -47.09000000000001, "pursuer_7": -47.09000000000001}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.22488281250001, "pursuer_1": -45.22488281250001, "pursuer_2": -45.22488281250001, "pursuer_3": -45.22488281250001, "pursuer_4": -45.22488281250001, "pursuer_5": -45.22488281250001, "pursuer_6": -45.22488281250001, "pursuer_7": -45.22488281250001}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987], "episode_lengths": [500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.492489638151946, "mean_inference_ms": 15.768584452177349, "mean_action_processing_ms": 1.0277554538050127, "mean_env_wait_ms": 10.61822947470533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009341537952423096, "StateBufferConnector_ms": 0.004222989082336426, "ViewRequirementAgentConnector_ms": 0.11031851172447205}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672, "num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 42.1658651851501, "num_env_steps_trained_throughput_per_sec": 42.1658651851501, "timesteps_total": 3584, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 28672, "timers": {"training_iteration_time_ms": 12581.295, "sample_time_ms": 3922.496, "learn_time_ms": 8641.271, "learn_throughput": 59.251, "synch_weights_time_ms": 16.049}, "counters": {"num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672}, "done": false, "episodes_total": 4, "training_iteration": 7, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-11-12", "timestamp": 1708024272, "time_this_iter_s": 12.15113639831543, "time_total_s": 88.1402702331543, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f8588641510>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 88.1402702331543, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 17.96111111111111, "ram_util_percent": 48.52222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1605970818549394, "cur_kl_coeff": 0.0062499999999999995, "cur_lr": 2e-05, "total_loss": -0.09558097817352973, "policy_loss": -0.008417816390283406, "vf_loss": 0.2936081878840923, "vf_explained_var": -0.19223659709095955, "kl": 0.00346817244135309, "entropy": 1.605868823826313, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 600.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8934841569513082, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 2e-05, "total_loss": -0.1032123267883435, "policy_loss": -0.01395319306757301, "vf_loss": 0.28439553286880254, "vf_explained_var": -0.8921831458806991, "kl": 0.0051448580285068605, "entropy": 1.6036605104804038, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 600.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9738166555762291, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 2e-05, "total_loss": -0.10268032820677035, "policy_loss": 0.00023703670594841242, "vf_loss": 0.2313182012178004, "vf_explained_var": -0.6394577957689762, "kl": 0.0022617847454966976, "entropy": 1.6075044870376587, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 600.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6503362346440553, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 2e-05, "total_loss": -0.11218607334885747, "policy_loss": -0.00404396285302937, "vf_loss": 0.20953754428774118, "vf_explained_var": -0.48350205942988395, "kl": 0.003920998238027096, "entropy": 1.6057550400495528, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 600.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.109510914236307, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 2e-05, "total_loss": -0.06295281005150173, "policy_loss": -0.010149796796031296, "vf_loss": 0.424723912589252, "vf_explained_var": -0.9380415469408036, "kl": 0.0035076618805760518, "entropy": 1.5898946866393089, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 600.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4851505503058433, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.003888863668544218, "policy_loss": -0.01398642749991268, "vf_loss": 0.6746997412294149, "vf_explained_var": -0.8235159993171692, "kl": 0.006771490263054148, "entropy": 1.5993166789412498, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 600.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0838220816105604, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": -0.10293466651564813, "policy_loss": -0.0031735305907204746, "vf_loss": 0.24179296232759953, "vf_explained_var": -0.03581964746117592, "kl": 0.006057685776613653, "entropy": 1.6051225498318673, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 600.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5649524286389351, "cur_kl_coeff": 0.0062499999999999995, "cur_lr": 2e-05, "total_loss": 0.026197886758018284, "policy_loss": 0.003362946165725589, "vf_loss": 0.730281139165163, "vf_explained_var": -0.9359195798635482, "kl": 0.00450698017666582, "entropy": 1.5976350992918014, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 600.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "sampler_results": {"episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -368.5631249999986, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -46.07039062500001, "pursuer_1": -46.07039062500001, "pursuer_2": -46.07039062500001, "pursuer_3": -46.07039062500001, "pursuer_4": -46.07039062500001, "pursuer_5": -46.07039062500001, "pursuer_6": -46.07039062500001, "pursuer_7": -46.07039062500001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4716082131851866, "mean_inference_ms": 15.6784341117996, "mean_action_processing_ms": 1.0220801285056467, "mean_env_wait_ms": 10.596056294748415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009540095925331116, "StateBufferConnector_ms": 0.00432133674621582, "ViewRequirementAgentConnector_ms": 0.11174492537975311}}, "episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -368.5631249999986, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -46.07039062500001, "pursuer_1": -46.07039062500001, "pursuer_2": -46.07039062500001, "pursuer_3": -46.07039062500001, "pursuer_4": -46.07039062500001, "pursuer_5": -46.07039062500001, "pursuer_6": -46.07039062500001, "pursuer_7": -46.07039062500001}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4716082131851866, "mean_inference_ms": 15.6784341117996, "mean_action_processing_ms": 1.0220801285056467, "mean_env_wait_ms": 10.596056294748415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009540095925331116, "StateBufferConnector_ms": 0.00432133674621582, "ViewRequirementAgentConnector_ms": 0.11174492537975311}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 41.37074522967113, "num_env_steps_trained_throughput_per_sec": 41.37074522967113, "timesteps_total": 4096, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 32768, "timers": {"training_iteration_time_ms": 12555.615, "sample_time_ms": 3931.893, "learn_time_ms": 8605.948, "learn_throughput": 59.494, "synch_weights_time_ms": 16.201}, "counters": {"num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "done": false, "episodes_total": 8, "training_iteration": 8, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-11-24", "timestamp": 1708024284, "time_this_iter_s": 12.38890552520752, "time_total_s": 100.52917575836182, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f8588732320>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 100.52917575836182, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.611764705882354, "ram_util_percent": 48.33529411764705}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8325429435819387, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 2e-05, "total_loss": -0.030112054300843738, "policy_loss": -0.0027544771088287233, "vf_loss": 0.5321179566904902, "vf_explained_var": -0.17765696346759796, "kl": 0.0036657935241237284, "entropy": 1.6039851874113082, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 680.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.774527682363987, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 2e-05, "total_loss": -0.1163196062319912, "policy_loss": -0.012328887172043324, "vf_loss": 0.22594038881361483, "vf_explained_var": -0.8761694401502609, "kl": 0.006240866918233223, "entropy": 1.6048556357622146, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 680.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0519265346229076, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": -0.049032283768610796, "policy_loss": 0.001935717836022377, "vf_loss": 0.43846667315810917, "vf_explained_var": -0.875961235165596, "kl": 0.002964295825222507, "entropy": 1.6058698073029518, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 680.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.74387665130198, "cur_kl_coeff": 0.0062499999999999995, "cur_lr": 2e-05, "total_loss": -0.11933624022640288, "policy_loss": -0.0050784092862159015, "vf_loss": 0.18552220379933715, "vf_explained_var": 0.1647062987089157, "kl": 0.004345711375935935, "entropy": 1.606655415892601, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 680.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9113260667771101, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": -0.08879647123394534, "policy_loss": -0.013258887338452041, "vf_loss": 0.3321431245654821, "vf_explained_var": -0.25585262253880503, "kl": 0.005869462533155456, "entropy": 1.5857794240117074, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 680.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3023772329092025, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.07683105778269236, "policy_loss": -0.014531203010119498, "vf_loss": 0.38352693915367125, "vf_explained_var": -0.3788103997707367, "kl": 0.008264306699857116, "entropy": 1.5983444809913636, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 680.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6734054535627365, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": -0.07442964380024933, "policy_loss": -0.0030276268953457475, "vf_loss": 0.3539777170866728, "vf_explained_var": 0.3996367737650871, "kl": 0.007480389758711681, "entropy": 1.6027046293020248, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 680.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5144140150398016, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 2e-05, "total_loss": -0.08356324034157296, "policy_loss": -0.006632301909849048, "vf_loss": 0.33331828098744154, "vf_explained_var": 0.29214386716485025, "kl": 0.00659768363693729, "entropy": 1.6028112441301345, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 680.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864}, "sampler_results": {"episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -368.5631249999986, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -46.07039062500001, "pursuer_1": -46.07039062500001, "pursuer_2": -46.07039062500001, "pursuer_3": -46.07039062500001, "pursuer_4": -46.07039062500001, "pursuer_5": -46.07039062500001, "pursuer_6": -46.07039062500001, "pursuer_7": -46.07039062500001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4716082131851866, "mean_inference_ms": 15.6784341117996, "mean_action_processing_ms": 1.0220801285056467, "mean_env_wait_ms": 10.596056294748415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009540095925331116, "StateBufferConnector_ms": 0.00432133674621582, "ViewRequirementAgentConnector_ms": 0.11174492537975311}}, "episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -368.5631249999986, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -46.07039062500001, "pursuer_1": -46.07039062500001, "pursuer_2": -46.07039062500001, "pursuer_3": -46.07039062500001, "pursuer_4": -46.07039062500001, "pursuer_5": -46.07039062500001, "pursuer_6": -46.07039062500001, "pursuer_7": -46.07039062500001}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4716082131851866, "mean_inference_ms": 15.6784341117996, "mean_action_processing_ms": 1.0220801285056467, "mean_env_wait_ms": 10.596056294748415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009540095925331116, "StateBufferConnector_ms": 0.00432133674621582, "ViewRequirementAgentConnector_ms": 0.11174492537975311}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864, "num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 42.60896908664504, "num_env_steps_trained_throughput_per_sec": 42.60896908664504, "timesteps_total": 4608, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 36864, "timers": {"training_iteration_time_ms": 12495.682, "sample_time_ms": 3921.299, "learn_time_ms": 8556.461, "learn_throughput": 59.838, "synch_weights_time_ms": 16.367}, "counters": {"num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864}, "done": false, "episodes_total": 8, "training_iteration": 9, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-11-37", "timestamp": 1708024297, "time_this_iter_s": 12.025179862976074, "time_total_s": 112.55435562133789, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f8588732830>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 112.55435562133789, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.61111111111111, "ram_util_percent": 48.51666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0170207742601634, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 2e-05, "total_loss": -0.09540747099090367, "policy_loss": -0.004010320012457669, "vf_loss": 0.27666941490024327, "vf_explained_var": -0.09701836332678795, "kl": 0.005073385027935728, "entropy": 1.6057242915034293, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 760.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8923279535025358, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 2e-05, "total_loss": -0.14507943974385853, "policy_loss": -0.017642890010029076, "vf_loss": 0.13130440255627035, "vf_explained_var": -0.0332825630903244, "kl": 0.0068071378162130715, "entropy": 1.6027328312397002, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 760.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0260241076350212, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 2e-05, "total_loss": -0.03291805499720794, "policy_loss": -0.01696569543564692, "vf_loss": 0.5783679246902466, "vf_explained_var": -0.9377035081386567, "kl": 0.0041453405865468085, "entropy": 1.6054595664143563, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 760.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1372653767466545, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 2e-05, "total_loss": -0.07531380536493089, "policy_loss": -0.0010114733828231691, "vf_loss": 0.345588700287044, "vf_explained_var": -0.1367371380329132, "kl": 0.0038717297313269226, "entropy": 1.6071160107851028, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 760.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7397979073226453, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": 0.10378301579476101, "policy_loss": -0.010166662349365651, "vf_loss": 1.089889557287097, "vf_explained_var": -0.9192867890000344, "kl": 0.005467996466904879, "entropy": 1.5852698117494584, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 760.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5851602129638196, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.07995048221782781, "policy_loss": -0.013179691042751074, "vf_loss": 0.3670549901202321, "vf_explained_var": 0.22116246968507766, "kl": 0.008402078208746389, "entropy": 1.602149525284767, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 760.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2034752890467644, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 0.33751791743561627, "policy_loss": -0.00440452522598207, "vf_loss": 2.008268290758133, "vf_explained_var": -0.8369493007659912, "kl": 0.008467711810953914, "entropy": 1.605680175125599, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 760.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5334221437573432, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 2e-05, "total_loss": 0.044242666952777655, "policy_loss": 0.002300290344282985, "vf_loss": 0.8092464521527291, "vf_explained_var": -0.9074600458145141, "kl": 0.0041733681689947845, "entropy": 1.6038227304816246, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 760.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "sampler_results": {"episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -368.5631249999986, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -46.07039062500001, "pursuer_1": -46.07039062500001, "pursuer_2": -46.07039062500001, "pursuer_3": -46.07039062500001, "pursuer_4": -46.07039062500001, "pursuer_5": -46.07039062500001, "pursuer_6": -46.07039062500001, "pursuer_7": -46.07039062500001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4716082131851866, "mean_inference_ms": 15.6784341117996, "mean_action_processing_ms": 1.0220801285056467, "mean_env_wait_ms": 10.596056294748415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009540095925331116, "StateBufferConnector_ms": 0.00432133674621582, "ViewRequirementAgentConnector_ms": 0.11174492537975311}}, "episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -368.5631249999986, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -46.07039062500001, "pursuer_1": -46.07039062500001, "pursuer_2": -46.07039062500001, "pursuer_3": -46.07039062500001, "pursuer_4": -46.07039062500001, "pursuer_5": -46.07039062500001, "pursuer_6": -46.07039062500001, "pursuer_7": -46.07039062500001}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4716082131851866, "mean_inference_ms": 15.6784341117996, "mean_action_processing_ms": 1.0220801285056467, "mean_env_wait_ms": 10.596056294748415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009540095925331116, "StateBufferConnector_ms": 0.00432133674621582, "ViewRequirementAgentConnector_ms": 0.11174492537975311}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 39.815950604483966, "num_env_steps_trained_throughput_per_sec": 39.815950604483966, "timesteps_total": 5120, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 40960, "timers": {"training_iteration_time_ms": 12532.026, "sample_time_ms": 3905.98, "learn_time_ms": 8608.149, "learn_throughput": 59.479, "synch_weights_time_ms": 16.344}, "counters": {"num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "done": false, "episodes_total": 8, "training_iteration": 10, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-11-50", "timestamp": 1708024310, "time_this_iter_s": 12.869858026504517, "time_total_s": 125.42421364784241, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f8588640820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 125.42421364784241, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 20.272222222222222, "ram_util_percent": 48.50555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.243757440894842, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 2e-05, "total_loss": 0.20844291822286323, "policy_loss": 8.243897464126349e-05, "vf_loss": 1.4749898172914981, "vf_explained_var": -0.8367792531847954, "kl": 0.004508376357262023, "entropy": 1.6039401799440385, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 840.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8968056857585907, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 2e-05, "total_loss": -0.0859558192503755, "policy_loss": -0.006445131124928593, "vf_loss": 0.3230076400563121, "vf_explained_var": -0.7720002278685569, "kl": 0.004416202229913324, "entropy": 1.6026949718594552, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 840.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9538479160517455, "cur_kl_coeff": 0.00019531249999999998, "cur_lr": 2e-05, "total_loss": -0.07031052377715241, "policy_loss": -0.006495490833185613, "vf_loss": 0.3871913444250822, "vf_explained_var": -0.31722988113760947, "kl": 0.0035621542716398834, "entropy": 1.6061356246471405, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 840.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3660487804561854, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 2e-05, "total_loss": -0.08122495722054737, "policy_loss": 0.0001907092984765768, "vf_loss": 0.31680988911539315, "vf_explained_var": -0.4193339504301548, "kl": 0.003305843743146397, "entropy": 1.6062330245971679, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 840.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.245557202026248, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": -0.11045911305118353, "policy_loss": -0.01679340365808457, "vf_loss": 0.2603457156568766, "vf_explained_var": 0.14252683892846107, "kl": 0.008930125943152234, "entropy": 1.5875911325216294, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 840.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.210312432795763, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.0670092107669916, "policy_loss": 6.398470140993595e-05, "vf_loss": 0.364327172935009, "vf_explained_var": 0.11361186429858208, "kl": 0.00879398569231853, "entropy": 1.5991378128528595, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 840.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4071432456374169, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": -0.04359266634928645, "policy_loss": -0.006388149689882994, "vf_loss": 0.4919352397322655, "vf_explained_var": -0.12733346968889236, "kl": 0.0067507146624848245, "entropy": 1.605258582532406, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 840.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1883710280060769, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 2e-05, "total_loss": -0.0007589154542074539, "policy_loss": -0.0008228024933487176, "vf_loss": 0.6393061898648739, "vf_explained_var": -0.23600721955299378, "kl": 0.005981964623788372, "entropy": 1.597720043361187, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 840.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056}, "sampler_results": {"episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -368.5631249999986, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -46.07039062500001, "pursuer_1": -46.07039062500001, "pursuer_2": -46.07039062500001, "pursuer_3": -46.07039062500001, "pursuer_4": -46.07039062500001, "pursuer_5": -46.07039062500001, "pursuer_6": -46.07039062500001, "pursuer_7": -46.07039062500001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4716082131851866, "mean_inference_ms": 15.6784341117996, "mean_action_processing_ms": 1.0220801285056467, "mean_env_wait_ms": 10.596056294748415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009540095925331116, "StateBufferConnector_ms": 0.00432133674621582, "ViewRequirementAgentConnector_ms": 0.11174492537975311}}, "episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -368.5631249999986, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -46.07039062500001, "pursuer_1": -46.07039062500001, "pursuer_2": -46.07039062500001, "pursuer_3": -46.07039062500001, "pursuer_4": -46.07039062500001, "pursuer_5": -46.07039062500001, "pursuer_6": -46.07039062500001, "pursuer_7": -46.07039062500001}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4716082131851866, "mean_inference_ms": 15.6784341117996, "mean_action_processing_ms": 1.0220801285056467, "mean_env_wait_ms": 10.596056294748415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009540095925331116, "StateBufferConnector_ms": 0.00432133674621582, "ViewRequirementAgentConnector_ms": 0.11174492537975311}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056, "num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 36.9991308626926, "num_env_steps_trained_throughput_per_sec": 36.9991308626926, "timesteps_total": 5632, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 45056, "timers": {"training_iteration_time_ms": 12568.412, "sample_time_ms": 3890.444, "learn_time_ms": 8660.065, "learn_throughput": 59.122, "synch_weights_time_ms": 16.437}, "counters": {"num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056}, "done": false, "episodes_total": 8, "training_iteration": 11, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-12-04", "timestamp": 1708024324, "time_this_iter_s": 13.848748445510864, "time_total_s": 139.27296209335327, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f8588732830>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 139.27296209335327, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 17.889999999999997, "ram_util_percent": 48.769999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3259512178599835, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": 0.0341982563606507, "policy_loss": -0.009939868282526732, "vf_loss": 0.8174207262694836, "vf_explained_var": -0.1078277848660946, "kl": 0.00647202281979844, "entropy": 1.6022210285067557, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 920.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0994904812425375, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": -0.05248478494104347, "policy_loss": 4.4485018588602546e-05, "vf_loss": 0.4318304378539324, "vf_explained_var": -0.1254570111632347, "kl": 0.0036719856812851503, "entropy": 1.6048974439501762, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 920.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7780387714505196, "cur_kl_coeff": 9.765624999999999e-05, "cur_lr": 2e-05, "total_loss": -0.09661823010828811, "policy_loss": -0.0010841762647032737, "vf_loss": 0.26002918984740975, "vf_explained_var": -0.10094740837812424, "kl": 0.004845250060316175, "entropy": 1.6054181948304176, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 920.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.252687993645668, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": 0.04882994888284884, "policy_loss": 0.0013125100173056125, "vf_loss": 0.8316648472100496, "vf_explained_var": -0.7279654987156391, "kl": 0.0049500314926262945, "entropy": 1.604026345908642, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 920.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9475878670811653, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": -0.06385910212120507, "policy_loss": -0.007050490356050432, "vf_loss": 0.41232593469321727, "vf_explained_var": -0.25126351937651636, "kl": 0.006039301981218159, "entropy": 1.5989481136202812, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 920.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1894027292728424, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.05541055814246647, "policy_loss": -0.001445287186652422, "vf_loss": 0.41906167212873696, "vf_explained_var": -0.400562983751297, "kl": 0.00728584254393354, "entropy": 1.6018785685300827, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 920.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3137597359716893, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 0.0936334353289567, "policy_loss": -0.005075006769038737, "vf_loss": 1.0370664589107037, "vf_explained_var": -0.8063118875026702, "kl": 0.004341926352935843, "entropy": 1.6077526345849038, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 920.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3078650757670403, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 2e-05, "total_loss": 0.03848403099400457, "policy_loss": -0.0061913647106848655, "vf_loss": 0.8168548602610827, "vf_explained_var": -0.5033666677772999, "kl": 0.00732229242566973, "entropy": 1.5954976111650467, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 920.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152}, "sampler_results": {"episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -367.9653124999991, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.995664062500005, "pursuer_1": -45.995664062500005, "pursuer_2": -45.995664062500005, "pursuer_3": -45.995664062500005, "pursuer_4": -45.995664062500005, "pursuer_5": -45.995664062500005, "pursuer_6": -45.995664062500005, "pursuer_7": -45.995664062500005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4594125499952906, "mean_inference_ms": 15.637146616148963, "mean_action_processing_ms": 1.0183740017400293, "mean_env_wait_ms": 10.574293026470187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009981294473012289, "StateBufferConnector_ms": 0.004306683937708537, "ViewRequirementAgentConnector_ms": 0.11137152711550395}}, "episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -367.9653124999991, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.995664062500005, "pursuer_1": -45.995664062500005, "pursuer_2": -45.995664062500005, "pursuer_3": -45.995664062500005, "pursuer_4": -45.995664062500005, "pursuer_5": -45.995664062500005, "pursuer_6": -45.995664062500005, "pursuer_7": -45.995664062500005}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4594125499952906, "mean_inference_ms": 15.637146616148963, "mean_action_processing_ms": 1.0183740017400293, "mean_env_wait_ms": 10.574293026470187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009981294473012289, "StateBufferConnector_ms": 0.004306683937708537, "ViewRequirementAgentConnector_ms": 0.11137152711550395}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 42.16234182129745, "num_env_steps_trained_throughput_per_sec": 42.16234182129745, "timesteps_total": 6144, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 49152, "timers": {"training_iteration_time_ms": 12483.903, "sample_time_ms": 3877.383, "learn_time_ms": 8587.875, "learn_throughput": 59.619, "synch_weights_time_ms": 17.173}, "counters": {"num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152}, "done": false, "episodes_total": 12, "training_iteration": 12, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-12-16", "timestamp": 1708024336, "time_this_iter_s": 12.15228819847107, "time_total_s": 151.42525029182434, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f8588643eb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 151.42525029182434, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 19.123529411764704, "ram_util_percent": 48.58235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9834490239620208, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": -0.07439221621025353, "policy_loss": -0.012023858586326241, "vf_loss": 0.3906126726418734, "vf_explained_var": 0.480543602257967, "kl": 0.0068564155080821365, "entropy": 1.6002687841653824, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1000.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5792016476392745, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 2e-05, "total_loss": 0.09044898595529957, "policy_loss": -0.006988983578048646, "vf_loss": 1.0302918337285518, "vf_explained_var": -0.49273799657821654, "kl": 0.005545640658237971, "entropy": 1.6013715088367462, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1000.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1829404026269912, "cur_kl_coeff": 4.8828124999999996e-05, "cur_lr": 2e-05, "total_loss": -0.03555177072375955, "policy_loss": -0.0071924249175935985, "vf_loss": 0.5293440259993076, "vf_explained_var": -0.39634923413395884, "kl": 0.0039061167946783824, "entropy": 1.60695541203022, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1000.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.640239390730858, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 2e-05, "total_loss": 0.09260678370192181, "policy_loss": -0.000621661136392504, "vf_loss": 1.0148730263113976, "vf_explained_var": -0.8923886641860008, "kl": 0.0037033436878118665, "entropy": 1.604912567138672, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1000.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0558380864560604, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": -0.05043607771513052, "policy_loss": 0.0008674360462464393, "vf_loss": 0.43262741826474665, "vf_explained_var": -0.6818014167249202, "kl": 0.006125314754899591, "entropy": 1.5946514800190925, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1000.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1159437097609044, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.07853418455924839, "policy_loss": 0.0012035969877615571, "vf_loss": 0.3142889153212309, "vf_explained_var": 0.43404100388288497, "kl": 0.00913912354153581, "entropy": 1.6013782992959023, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1000.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0623250618577003, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 2e-05, "total_loss": -0.05955762763187522, "policy_loss": -0.005067188222892582, "vf_loss": 0.4239916380494833, "vf_explained_var": 0.009330714493989945, "kl": 0.005854404479032382, "entropy": 1.6063470527529717, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1000.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1899983406066894, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 2e-05, "total_loss": -0.045041671598482935, "policy_loss": 0.0027251912048086523, "vf_loss": 0.4480784319341183, "vf_explained_var": -0.0978055939078331, "kl": 0.007570407813182101, "entropy": 1.5979829490184785, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1000.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248}, "sampler_results": {"episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -367.9653124999991, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.995664062500005, "pursuer_1": -45.995664062500005, "pursuer_2": -45.995664062500005, "pursuer_3": -45.995664062500005, "pursuer_4": -45.995664062500005, "pursuer_5": -45.995664062500005, "pursuer_6": -45.995664062500005, "pursuer_7": -45.995664062500005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4594125499952906, "mean_inference_ms": 15.637146616148963, "mean_action_processing_ms": 1.0183740017400293, "mean_env_wait_ms": 10.574293026470187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009981294473012289, "StateBufferConnector_ms": 0.004306683937708537, "ViewRequirementAgentConnector_ms": 0.11137152711550395}}, "episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -367.9653124999991, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.995664062500005, "pursuer_1": -45.995664062500005, "pursuer_2": -45.995664062500005, "pursuer_3": -45.995664062500005, "pursuer_4": -45.995664062500005, "pursuer_5": -45.995664062500005, "pursuer_6": -45.995664062500005, "pursuer_7": -45.995664062500005}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4594125499952906, "mean_inference_ms": 15.637146616148963, "mean_action_processing_ms": 1.0183740017400293, "mean_env_wait_ms": 10.574293026470187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009981294473012289, "StateBufferConnector_ms": 0.004306683937708537, "ViewRequirementAgentConnector_ms": 0.11137152711550395}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248, "num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 42.86011845688907, "num_env_steps_trained_throughput_per_sec": 42.86011845688907, "timesteps_total": 6656, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 53248, "timers": {"training_iteration_time_ms": 12397.571, "sample_time_ms": 3865.561, "learn_time_ms": 8513.536, "learn_throughput": 60.14, "synch_weights_time_ms": 17.015}, "counters": {"num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248}, "done": false, "episodes_total": 12, "training_iteration": 13, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-12-28", "timestamp": 1708024348, "time_this_iter_s": 11.954510927200317, "time_total_s": 163.37976121902466, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f8588643ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 163.37976121902466, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.68888888888889, "ram_util_percent": 48.68333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1942302204668522, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": -0.06565897588152439, "policy_loss": -0.0022273171925917268, "vf_loss": 0.38509778808802364, "vf_explained_var": -0.6059495076537132, "kl": 0.006370475218864158, "entropy": 1.5971107855439186, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1080.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1563530370593071, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 2e-05, "total_loss": -0.0462528569449205, "policy_loss": -0.013862457918003201, "vf_loss": 0.5112172720953823, "vf_explained_var": -0.868296155333519, "kl": 0.0045532601681770755, "entropy": 1.6019649401307106, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1080.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8273718036711216, "cur_kl_coeff": 2.4414062499999998e-05, "cur_lr": 2e-05, "total_loss": -0.12742615193710663, "policy_loss": -0.0030300416285172103, "vf_loss": 0.14491135692223905, "vf_explained_var": 0.41773011088371276, "kl": 0.0035059567278949546, "entropy": 1.6062403559684753, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1080.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7898427620530128, "cur_kl_coeff": 0.00019531249999999998, "cur_lr": 2e-05, "total_loss": -0.10842463510562084, "policy_loss": -0.002488916227594018, "vf_loss": 0.21862742062658072, "vf_explained_var": -0.03695701882243156, "kl": 0.004470661480445415, "entropy": 1.6059344381093978, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1080.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0969959549605846, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": -0.09777977655030554, "policy_loss": -0.0004175791749730706, "vf_loss": 0.24927541641518475, "vf_explained_var": -0.2382425084710121, "kl": 0.0053409666114021094, "entropy": 1.5968522131443024, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1080.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1597861424088478, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.044409403583267705, "policy_loss": -0.020090507552959026, "vf_loss": 0.5339007645845413, "vf_explained_var": -0.19662793055176736, "kl": 0.010210588306654245, "entropy": 1.5983620226383208, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1080.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.546149407327175, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 2e-05, "total_loss": 0.006692826392827556, "policy_loss": -0.0002661387901753187, "vf_loss": 0.669286561012268, "vf_explained_var": -0.622395483404398, "kl": 0.005845840013353154, "entropy": 1.6050881803035737, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1080.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.614720119535923, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 2e-05, "total_loss": 0.20027381500694902, "policy_loss": 0.001126103347633034, "vf_loss": 1.438333149254322, "vf_explained_var": -0.9858012706041336, "kl": 0.004242081491975113, "entropy": 1.604422004520893, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1080.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344}, "sampler_results": {"episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -367.9653124999991, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.995664062500005, "pursuer_1": -45.995664062500005, "pursuer_2": -45.995664062500005, "pursuer_3": -45.995664062500005, "pursuer_4": -45.995664062500005, "pursuer_5": -45.995664062500005, "pursuer_6": -45.995664062500005, "pursuer_7": -45.995664062500005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4594125499952906, "mean_inference_ms": 15.637146616148963, "mean_action_processing_ms": 1.0183740017400293, "mean_env_wait_ms": 10.574293026470187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009981294473012289, "StateBufferConnector_ms": 0.004306683937708537, "ViewRequirementAgentConnector_ms": 0.11137152711550395}}, "episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -367.9653124999991, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.995664062500005, "pursuer_1": -45.995664062500005, "pursuer_2": -45.995664062500005, "pursuer_3": -45.995664062500005, "pursuer_4": -45.995664062500005, "pursuer_5": -45.995664062500005, "pursuer_6": -45.995664062500005, "pursuer_7": -45.995664062500005}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4594125499952906, "mean_inference_ms": 15.637146616148963, "mean_action_processing_ms": 1.0183740017400293, "mean_env_wait_ms": 10.574293026470187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009981294473012289, "StateBufferConnector_ms": 0.004306683937708537, "ViewRequirementAgentConnector_ms": 0.11137152711550395}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 42.13993555670624, "num_env_steps_trained_throughput_per_sec": 42.13993555670624, "timesteps_total": 7168, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 57344, "timers": {"training_iteration_time_ms": 12429.789, "sample_time_ms": 3873.234, "learn_time_ms": 8537.551, "learn_throughput": 59.97, "synch_weights_time_ms": 17.537}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344}, "done": false, "episodes_total": 12, "training_iteration": 14, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-12-40", "timestamp": 1708024360, "time_this_iter_s": 12.160309791564941, "time_total_s": 175.5400710105896, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f85886417e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 175.5400710105896, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 19.029411764705884, "ram_util_percent": 48.752941176470586}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1775926932692529, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": -0.055851393095508683, "policy_loss": -0.008089343598112465, "vf_loss": 0.4484543435275555, "vf_explained_var": 0.0504189096391201, "kl": 0.005379818062647246, "entropy": 1.5987983614206314, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1160.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9262148093432188, "cur_kl_coeff": 0.00019531249999999998, "cur_lr": 2e-05, "total_loss": -0.10755819566911669, "policy_loss": -0.013555285532493144, "vf_loss": 0.26197832971811297, "vf_explained_var": 0.4152041107416153, "kl": 0.005895907510421239, "entropy": 1.5949863910675048, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1160.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.599221359938383, "cur_kl_coeff": 1.2207031249999999e-05, "cur_lr": 2e-05, "total_loss": 0.13874793961294926, "policy_loss": 0.0008777331793680787, "vf_loss": 1.1940022200345992, "vf_explained_var": -0.14733786806464194, "kl": 0.0033300133130978794, "entropy": 1.6063038468360902, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1160.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.31457112878561, "cur_kl_coeff": 9.765624999999999e-05, "cur_lr": 2e-05, "total_loss": 0.0046335997525602576, "policy_loss": -0.0026480579748749734, "vf_loss": 0.6714112985879183, "vf_explained_var": -0.9369474858045578, "kl": 0.005333400162635371, "entropy": 1.6057168573141098, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1160.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7510085545480252, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": 0.05116643389774254, "policy_loss": -0.0004960298538208008, "vf_loss": 0.8475798215717077, "vf_explained_var": -0.8794721320271492, "kl": 0.006044065265450626, "entropy": 1.6023720607161522, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1160.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2720428675413131, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.005624745419481769, "policy_loss": -0.011414788628462702, "vf_loss": 0.6512381702661514, "vf_explained_var": -0.10340728834271432, "kl": 0.01065026237629354, "entropy": 1.5914954960346221, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1160.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2937142834067346, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 2e-05, "total_loss": -0.005607554230664391, "policy_loss": -0.004437040816992521, "vf_loss": 0.6369611695408821, "vf_explained_var": -0.9396784573793411, "kl": 0.0059561110858339815, "entropy": 1.6055970668792725, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1160.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1453775383532045, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": 0.14106408529914916, "policy_loss": -0.0023671412491239607, "vf_loss": 1.2161425083875657, "vf_explained_var": -0.8263688132166862, "kl": 0.003867075344896875, "entropy": 1.6060741975903512, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1160.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440}, "sampler_results": {"episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -367.9653124999991, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.995664062500005, "pursuer_1": -45.995664062500005, "pursuer_2": -45.995664062500005, "pursuer_3": -45.995664062500005, "pursuer_4": -45.995664062500005, "pursuer_5": -45.995664062500005, "pursuer_6": -45.995664062500005, "pursuer_7": -45.995664062500005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4594125499952906, "mean_inference_ms": 15.637146616148963, "mean_action_processing_ms": 1.0183740017400293, "mean_env_wait_ms": 10.574293026470187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009981294473012289, "StateBufferConnector_ms": 0.004306683937708537, "ViewRequirementAgentConnector_ms": 0.11137152711550395}}, "episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -367.9653124999991, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.995664062500005, "pursuer_1": -45.995664062500005, "pursuer_2": -45.995664062500005, "pursuer_3": -45.995664062500005, "pursuer_4": -45.995664062500005, "pursuer_5": -45.995664062500005, "pursuer_6": -45.995664062500005, "pursuer_7": -45.995664062500005}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4594125499952906, "mean_inference_ms": 15.637146616148963, "mean_action_processing_ms": 1.0183740017400293, "mean_env_wait_ms": 10.574293026470187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009981294473012289, "StateBufferConnector_ms": 0.004306683937708537, "ViewRequirementAgentConnector_ms": 0.11137152711550395}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440, "num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 31.40190546897264, "num_env_steps_trained_throughput_per_sec": 31.40190546897264, "timesteps_total": 7680, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 61440, "timers": {"training_iteration_time_ms": 12870.649, "sample_time_ms": 3865.649, "learn_time_ms": 8985.954, "learn_throughput": 56.978, "synch_weights_time_ms": 17.561}, "counters": {"num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440}, "done": false, "episodes_total": 12, "training_iteration": 15, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-12-57", "timestamp": 1708024377, "time_this_iter_s": 16.318406581878662, "time_total_s": 191.85847759246826, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f8588643eb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 191.85847759246826, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 16.678260869565218, "ram_util_percent": 48.786956521739114}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1535858809947968, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": 0.04020593746536179, "policy_loss": -0.009669169946573675, "vf_loss": 0.8405125826597214, "vf_explained_var": -0.8571866795420646, "kl": 0.008343582623638213, "entropy": 1.6025955468416213, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1240.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2445567335933447, "cur_kl_coeff": 0.00019531249999999998, "cur_lr": 2e-05, "total_loss": -0.07301380179933403, "policy_loss": -0.007099611056037247, "vf_loss": 0.3749547515064478, "vf_explained_var": -0.3781015172600746, "kl": 0.00789816324831918, "entropy": 1.596544162929058, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1240.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0167704336345196, "cur_kl_coeff": 6.1035156249999995e-06, "cur_lr": 2e-05, "total_loss": -0.06741931860160548, "policy_loss": -0.005132082127965986, "vf_loss": 0.3932776117697358, "vf_explained_var": 0.4423954874277115, "kl": 0.0032540648331632837, "entropy": 1.6060665294528007, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1240.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8053869210183621, "cur_kl_coeff": 9.765624999999999e-05, "cur_lr": 2e-05, "total_loss": -0.07528551680043165, "policy_loss": -0.008772965625394136, "vf_loss": 0.37608097344636915, "vf_explained_var": -0.34798016846179963, "kl": 0.004190612721140496, "entropy": 1.6053319975733757, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1240.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.602049758285284, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": -0.011368776904419065, "policy_loss": 0.0005292255664244294, "vf_loss": 0.5898744866251946, "vf_explained_var": -0.28616848811507223, "kl": 0.008013756241416559, "entropy": 1.5937288269400596, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1240.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1033940821886064, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.05855667092837393, "policy_loss": -0.0023961378494277595, "vf_loss": 0.40530350208282473, "vf_explained_var": -0.6009295962750911, "kl": 0.010119800968095661, "entropy": 1.5951036840677262, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1240.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5037467170506715, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 2e-05, "total_loss": -0.05067732482930296, "policy_loss": -0.006220178375951946, "vf_loss": 0.4640876293182373, "vf_explained_var": 0.3501723177731037, "kl": 0.003812242523417808, "entropy": 1.6057436019182205, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1240.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3969046242535115, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 2e-05, "total_loss": 0.14157727410201915, "policy_loss": -0.009012524341233074, "vf_loss": 1.241546455770731, "vf_explained_var": 0.10870345234870911, "kl": 0.005594678729539737, "entropy": 1.5979899778962134, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1240.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 65536}, "sampler_results": {"episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.2632812499992, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.78291015625, "pursuer_1": -45.78291015625, "pursuer_2": -45.78291015625, "pursuer_3": -45.78291015625, "pursuer_4": -45.78291015625, "pursuer_5": -45.78291015625, "pursuer_6": -45.78291015625, "pursuer_7": -45.78291015625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.455932849942292, "mean_inference_ms": 15.609114555061222, "mean_action_processing_ms": 1.016049262483258, "mean_env_wait_ms": 10.555043424167074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010055117309093475, "StateBufferConnector_ms": 0.0044794753193855286, "ViewRequirementAgentConnector_ms": 0.11497680097818375}}, "episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.2632812499992, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.78291015625, "pursuer_1": -45.78291015625, "pursuer_2": -45.78291015625, "pursuer_3": -45.78291015625, "pursuer_4": -45.78291015625, "pursuer_5": -45.78291015625, "pursuer_6": -45.78291015625, "pursuer_7": -45.78291015625}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.455932849942292, "mean_inference_ms": 15.609114555061222, "mean_action_processing_ms": 1.016049262483258, "mean_env_wait_ms": 10.555043424167074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010055117309093475, "StateBufferConnector_ms": 0.0044794753193855286, "ViewRequirementAgentConnector_ms": 0.11497680097818375}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 65536, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 40.83814717807586, "num_env_steps_trained_throughput_per_sec": 40.83814717807586, "timesteps_total": 8192, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 65536, "timers": {"training_iteration_time_ms": 12831.301, "sample_time_ms": 3864.528, "learn_time_ms": 8947.658, "learn_throughput": 57.222, "synch_weights_time_ms": 17.647}, "counters": {"num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 65536}, "done": false, "episodes_total": 16, "training_iteration": 16, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-13-09", "timestamp": 1708024389, "time_this_iter_s": 12.54697299003601, "time_total_s": 204.40545058250427, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f85886583a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 204.40545058250427, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 18.23888888888889, "ram_util_percent": 48.577777777777776}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4794986806809902, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": -0.10451623460103292, "policy_loss": -0.007868066057562828, "vf_loss": 0.25532843535766003, "vf_explained_var": 0.06919669806957245, "kl": 0.00788622508989647, "entropy": 1.6048643469810486, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1320.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1204866342246533, "cur_kl_coeff": 0.00019531249999999998, "cur_lr": 2e-05, "total_loss": -0.0651378962207673, "policy_loss": 0.0025113275041803718, "vf_loss": 0.36901481468230485, "vf_explained_var": -0.5272115834057332, "kl": 0.008686203818069772, "entropy": 1.5990462109446526, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1320.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5464797921478748, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 2e-05, "total_loss": 0.12632257356890478, "policy_loss": -0.0063117025420069695, "vf_loss": 1.1720069527626038, "vf_explained_var": -0.8442460015416146, "kl": 0.0037123787769814953, "entropy": 1.6036746993660926, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1320.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1756639793515204, "cur_kl_coeff": 4.8828124999999996e-05, "cur_lr": 2e-05, "total_loss": -0.04061988955290872, "policy_loss": 0.002511503081768751, "vf_loss": 0.467743968218565, "vf_explained_var": -0.948445251584053, "kl": 0.010263098927680403, "entropy": 1.6006788432598114, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1320.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3971042063087225, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": -0.07530107703933027, "policy_loss": -0.013601954560726881, "vf_loss": 0.38639535680413245, "vf_explained_var": -0.06739894822239875, "kl": 0.015949811204336584, "entropy": 1.5831042185425759, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1320.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5007536314427852, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.022530134179396553, "policy_loss": 0.0010060183703899384, "vf_loss": 0.5364786494523287, "vf_explained_var": 0.3173656605184078, "kl": 0.009528305975254624, "entropy": 1.5956147477030753, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1320.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1113076969981193, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 2e-05, "total_loss": 0.03209941148816142, "policy_loss": -0.005189988249912858, "vf_loss": 0.7909137830138206, "vf_explained_var": -0.37698609456419946, "kl": 0.00633817859343253, "entropy": 1.6051827117800712, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1320.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.01599738933146, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 2e-05, "total_loss": -0.06392146949801827, "policy_loss": -0.001660102349705994, "vf_loss": 0.39347195737063884, "vf_explained_var": 0.28758359849452975, "kl": 0.00660322816693224, "entropy": 1.6063193291425706, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1320.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 69632}, "sampler_results": {"episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.2632812499992, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.78291015625, "pursuer_1": -45.78291015625, "pursuer_2": -45.78291015625, "pursuer_3": -45.78291015625, "pursuer_4": -45.78291015625, "pursuer_5": -45.78291015625, "pursuer_6": -45.78291015625, "pursuer_7": -45.78291015625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.455932849942292, "mean_inference_ms": 15.609114555061222, "mean_action_processing_ms": 1.016049262483258, "mean_env_wait_ms": 10.555043424167074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010055117309093475, "StateBufferConnector_ms": 0.0044794753193855286, "ViewRequirementAgentConnector_ms": 0.11497680097818375}}, "episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.2632812499992, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.78291015625, "pursuer_1": -45.78291015625, "pursuer_2": -45.78291015625, "pursuer_3": -45.78291015625, "pursuer_4": -45.78291015625, "pursuer_5": -45.78291015625, "pursuer_6": -45.78291015625, "pursuer_7": -45.78291015625}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.455932849942292, "mean_inference_ms": 15.609114555061222, "mean_action_processing_ms": 1.016049262483258, "mean_env_wait_ms": 10.555043424167074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010055117309093475, "StateBufferConnector_ms": 0.0044794753193855286, "ViewRequirementAgentConnector_ms": 0.11497680097818375}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 69632, "num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 40.58731507375976, "num_env_steps_trained_throughput_per_sec": 40.58731507375976, "timesteps_total": 8704, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 69632, "timers": {"training_iteration_time_ms": 12878.527, "sample_time_ms": 3868.515, "learn_time_ms": 8990.747, "learn_throughput": 56.947, "synch_weights_time_ms": 17.773}, "counters": {"num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 69632}, "done": false, "episodes_total": 16, "training_iteration": 17, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-13-22", "timestamp": 1708024402, "time_this_iter_s": 12.627241134643555, "time_total_s": 217.03269171714783, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f8588658940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 217.03269171714783, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 18.611111111111107, "ram_util_percent": 48.71111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9233279168605804, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": 0.2980078837601468, "policy_loss": 0.008539567491970957, "vf_loss": 1.7994344502687454, "vf_explained_var": -0.999144335091114, "kl": 0.006975134433014318, "entropy": 1.6039574190974235, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1400.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3394373454153539, "cur_kl_coeff": 0.00019531249999999998, "cur_lr": 2e-05, "total_loss": -0.0255263156053843, "policy_loss": 0.006029796251095831, "vf_loss": 0.515422997251153, "vf_explained_var": -0.2818462274968624, "kl": 0.005714054533746094, "entropy": 1.6041297405958175, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1400.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.028258278220892, "cur_kl_coeff": 1.5258789062499999e-06, "cur_lr": 2e-05, "total_loss": -0.07012964070599992, "policy_loss": -0.00554758682847023, "vf_loss": 0.38353565223515035, "vf_explained_var": -0.35420375093817713, "kl": 0.0041280281147919595, "entropy": 1.604659730195999, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1400.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3713009908795357, "cur_kl_coeff": 4.8828124999999996e-05, "cur_lr": 2e-05, "total_loss": -0.051329797415382926, "policy_loss": -0.004532467864919454, "vf_loss": 0.4540943520143628, "vf_explained_var": -0.6736510537564755, "kl": 0.0059388050809502605, "entropy": 1.6032120451331138, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1400.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3177653729915617, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": 0.1655499231797876, "policy_loss": -0.017386028054170312, "vf_loss": 1.3707562565803528, "vf_explained_var": -0.8587860032916069, "kl": 0.015913803572766484, "entropy": 1.5976554349064827, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1400.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9120629988610744, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.07659391640045214, "policy_loss": 0.005900752707384526, "vf_loss": 0.29910739362239835, "vf_explained_var": 0.26429309174418447, "kl": 0.009109436185099185, "entropy": 1.5909340322017669, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1400.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3202905237674714, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 2e-05, "total_loss": -0.0005132544436492025, "policy_loss": -0.004505820065969601, "vf_loss": 0.6587896510958672, "vf_explained_var": 0.05091238245368004, "kl": 0.0038637290883343665, "entropy": 1.6075314104557037, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1400.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.543192408233881, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 2e-05, "total_loss": 0.09013317896751687, "policy_loss": -0.00925867969635874, "vf_loss": 1.0341770678758622, "vf_explained_var": -0.40156025215983393, "kl": 0.009425094403559342, "entropy": 1.5915609046816825, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1400.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 73728}, "sampler_results": {"episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.2632812499992, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.78291015625, "pursuer_1": -45.78291015625, "pursuer_2": -45.78291015625, "pursuer_3": -45.78291015625, "pursuer_4": -45.78291015625, "pursuer_5": -45.78291015625, "pursuer_6": -45.78291015625, "pursuer_7": -45.78291015625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.455932849942292, "mean_inference_ms": 15.609114555061222, "mean_action_processing_ms": 1.016049262483258, "mean_env_wait_ms": 10.555043424167074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010055117309093475, "StateBufferConnector_ms": 0.0044794753193855286, "ViewRequirementAgentConnector_ms": 0.11497680097818375}}, "episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.2632812499992, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.78291015625, "pursuer_1": -45.78291015625, "pursuer_2": -45.78291015625, "pursuer_3": -45.78291015625, "pursuer_4": -45.78291015625, "pursuer_5": -45.78291015625, "pursuer_6": -45.78291015625, "pursuer_7": -45.78291015625}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.455932849942292, "mean_inference_ms": 15.609114555061222, "mean_action_processing_ms": 1.016049262483258, "mean_env_wait_ms": 10.555043424167074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010055117309093475, "StateBufferConnector_ms": 0.0044794753193855286, "ViewRequirementAgentConnector_ms": 0.11497680097818375}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 73728, "num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 38.5442418753863, "num_env_steps_trained_throughput_per_sec": 38.5442418753863, "timesteps_total": 9216, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 73728, "timers": {"training_iteration_time_ms": 12969.281, "sample_time_ms": 3853.44, "learn_time_ms": 9096.888, "learn_throughput": 56.283, "synch_weights_time_ms": 17.554}, "counters": {"num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 73728}, "done": false, "episodes_total": 16, "training_iteration": 18, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-13-35", "timestamp": 1708024415, "time_this_iter_s": 13.292871236801147, "time_total_s": 230.32556295394897, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f8588643eb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 230.32556295394897, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.22105263157895, "ram_util_percent": 48.731578947368426}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8081193372607232, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": 0.13749176900346355, "policy_loss": -0.002778551366645843, "vf_loss": 1.2019877754151822, "vf_explained_var": -0.9453528642654419, "kl": 0.0054115248116431754, "entropy": 1.6023084983229636, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1480.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8408557638525962, "cur_kl_coeff": 0.00019531249999999998, "cur_lr": 2e-05, "total_loss": 0.06673372864097474, "policy_loss": -0.004527111281640827, "vf_loss": 0.926074831187725, "vf_explained_var": -0.7503218442201615, "kl": 0.004935432126512751, "entropy": 1.6025882929563522, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1480.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4355330143123866, "cur_kl_coeff": 7.629394531249999e-07, "cur_lr": 2e-05, "total_loss": -0.07721585126128047, "policy_loss": 0.002995274914428592, "vf_loss": 0.32044251188635825, "vf_explained_var": 0.026887381821870802, "kl": 0.0029384378343820573, "entropy": 1.603217539191246, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1480.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4669015111401678, "cur_kl_coeff": 4.8828124999999996e-05, "cur_lr": 2e-05, "total_loss": -0.08060171502875164, "policy_loss": -0.006921753496862948, "vf_loss": 0.34675578866153955, "vf_explained_var": 0.04477724134922027, "kl": 0.006300224835285917, "entropy": 1.603692165017128, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1480.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.611516260355711, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": -0.06421761825622525, "policy_loss": -0.005351333413273096, "vf_loss": 0.3984361233189702, "vf_explained_var": -0.31311267614364624, "kl": 0.012341144343372435, "entropy": 1.5848495274782182, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1480.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7607026647776365, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.09261765126138925, "policy_loss": -0.004836592124775052, "vf_loss": 0.27590911407023666, "vf_explained_var": 0.20621753558516503, "kl": 0.011533121974207462, "entropy": 1.5906495690345763, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1480.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9401814587414266, "cur_kl_coeff": 0.0062499999999999995, "cur_lr": 2e-05, "total_loss": 0.22232246850171578, "policy_loss": 0.0018054105108603834, "vf_loss": 1.5251843236386775, "vf_explained_var": -0.7990806445479393, "kl": 0.0034917172393761574, "entropy": 1.608008447289467, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1480.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8697840627282858, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 2e-05, "total_loss": -0.07916921913201805, "policy_loss": -0.0038136653369292618, "vf_loss": 0.336886035464704, "vf_explained_var": 0.1314563125371933, "kl": 0.011040438734926283, "entropy": 1.5958137154579162, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1480.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 77824}, "sampler_results": {"episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.2632812499992, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.78291015625, "pursuer_1": -45.78291015625, "pursuer_2": -45.78291015625, "pursuer_3": -45.78291015625, "pursuer_4": -45.78291015625, "pursuer_5": -45.78291015625, "pursuer_6": -45.78291015625, "pursuer_7": -45.78291015625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.455932849942292, "mean_inference_ms": 15.609114555061222, "mean_action_processing_ms": 1.016049262483258, "mean_env_wait_ms": 10.555043424167074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010055117309093475, "StateBufferConnector_ms": 0.0044794753193855286, "ViewRequirementAgentConnector_ms": 0.11497680097818375}}, "episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.2632812499992, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.78291015625, "pursuer_1": -45.78291015625, "pursuer_2": -45.78291015625, "pursuer_3": -45.78291015625, "pursuer_4": -45.78291015625, "pursuer_5": -45.78291015625, "pursuer_6": -45.78291015625, "pursuer_7": -45.78291015625}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.455932849942292, "mean_inference_ms": 15.609114555061222, "mean_action_processing_ms": 1.016049262483258, "mean_env_wait_ms": 10.555043424167074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010055117309093475, "StateBufferConnector_ms": 0.0044794753193855286, "ViewRequirementAgentConnector_ms": 0.11497680097818375}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 77824, "num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 41.51391744623535, "num_env_steps_trained_throughput_per_sec": 41.51391744623535, "timesteps_total": 9728, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 77824, "timers": {"training_iteration_time_ms": 13000.977, "sample_time_ms": 3865.515, "learn_time_ms": 9116.165, "learn_throughput": 56.164, "synch_weights_time_ms": 17.884}, "counters": {"num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 77824}, "done": false, "episodes_total": 16, "training_iteration": 19, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-13-48", "timestamp": 1708024428, "time_this_iter_s": 12.34402084350586, "time_total_s": 242.66958379745483, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f8588640790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 242.66958379745483, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.45555555555556, "ram_util_percent": 48.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0361066102981566, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": -0.06559619486797601, "policy_loss": -0.013409945904277265, "vf_loss": 0.4321190569549799, "vf_explained_var": 0.23486500829458237, "kl": 0.008543308946536854, "entropy": 1.6022268414497376, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1560.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1952596053481102, "cur_kl_coeff": 9.765624999999999e-05, "cur_lr": 2e-05, "total_loss": -0.030231243831804023, "policy_loss": -0.004257529211463407, "vf_loss": 0.5381876047700643, "vf_explained_var": -0.3452194884419441, "kl": 0.004172568739159032, "entropy": 1.605210191011429, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1560.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6201458364725112, "cur_kl_coeff": 3.8146972656249997e-07, "cur_lr": 2e-05, "total_loss": 0.08725540781160816, "policy_loss": -0.007559302530717104, "vf_loss": 1.020846899598837, "vf_explained_var": 0.15179680660367012, "kl": 0.003300233359914273, "entropy": 1.6039701268076896, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1560.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7804129265248776, "cur_kl_coeff": 4.8828124999999996e-05, "cur_lr": 2e-05, "total_loss": 0.07874027498764917, "policy_loss": -0.009057681960985064, "vf_loss": 0.9934788662940264, "vf_explained_var": -0.1033663272857666, "kl": 0.004965311737032607, "entropy": 1.6057199984788895, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1560.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6731369152665139, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": 0.043300053134953484, "policy_loss": -0.017818272137083112, "vf_loss": 0.8822171084582806, "vf_explained_var": -0.5105710506439209, "kl": 0.006545993697363884, "entropy": 1.5944106429815292, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1560.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7426899440586567, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": 0.020812823905725964, "policy_loss": -0.0028855427633970978, "vf_loss": 0.7267236024141311, "vf_explained_var": 0.1505573458969593, "kl": 0.007860229397192598, "entropy": 1.5955457910895348, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1560.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7568819731473924, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 2e-05, "total_loss": 0.3779516394761231, "policy_loss": -0.0072074155556038026, "vf_loss": 2.1829306915402413, "vf_explained_var": -0.9862482756376266, "kl": 0.005178941751364618, "entropy": 1.605898056924343, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1560.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6611432813107967, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 2e-05, "total_loss": 0.031023038034982166, "policy_loss": -0.007348464766982943, "vf_loss": 0.7934279695153237, "vf_explained_var": 0.031102577596902846, "kl": 0.00890992204658687, "entropy": 1.5998897179961205, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1560.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920}, "sampler_results": {"episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.78406249999944, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.8480078125, "pursuer_1": -45.8480078125, "pursuer_2": -45.8480078125, "pursuer_3": -45.8480078125, "pursuer_4": -45.8480078125, "pursuer_5": -45.8480078125, "pursuer_6": -45.8480078125, "pursuer_7": -45.8480078125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204, -374.6200000000009, -376.6025000000013, -348.4362500000003, -375.8099999999997], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4515221088698236, "mean_inference_ms": 15.584784842924872, "mean_action_processing_ms": 1.0134432244672937, "mean_env_wait_ms": 10.535290373251263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009785294532775879, "StateBufferConnector_ms": 0.004417002201080322, "ViewRequirementAgentConnector_ms": 0.1139231026172638}}, "episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.78406249999944, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.8480078125, "pursuer_1": -45.8480078125, "pursuer_2": -45.8480078125, "pursuer_3": -45.8480078125, "pursuer_4": -45.8480078125, "pursuer_5": -45.8480078125, "pursuer_6": -45.8480078125, "pursuer_7": -45.8480078125}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204, -374.6200000000009, -376.6025000000013, -348.4362500000003, -375.8099999999997], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4515221088698236, "mean_inference_ms": 15.584784842924872, "mean_action_processing_ms": 1.0134432244672937, "mean_env_wait_ms": 10.535290373251263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009785294532775879, "StateBufferConnector_ms": 0.004417002201080322, "ViewRequirementAgentConnector_ms": 0.1139231026172638}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 43.385180341900856, "num_env_steps_trained_throughput_per_sec": 43.385180341900856, "timesteps_total": 10240, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 81920, "timers": {"training_iteration_time_ms": 12895.186, "sample_time_ms": 3866.53, "learn_time_ms": 9009.479, "learn_throughput": 56.829, "synch_weights_time_ms": 17.763}, "counters": {"num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920}, "done": false, "episodes_total": 20, "training_iteration": 20, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-14-00", "timestamp": 1708024440, "time_this_iter_s": 11.811039924621582, "time_total_s": 254.48062372207642, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f8588642200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 254.48062372207642, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 18.511764705882356, "ram_util_percent": 48.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1025485239923, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": -0.09809812465682625, "policy_loss": -0.015358964703045786, "vf_loss": 0.3091254770755768, "vf_explained_var": -0.2066560499370098, "kl": 0.0102965232625138, "entropy": 1.6002856969833374, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1640.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2033522680401803, "cur_kl_coeff": 4.8828124999999996e-05, "cur_lr": 2e-05, "total_loss": -0.03979208276141435, "policy_loss": -0.007970583904534579, "vf_loss": 0.5133658770471812, "vf_explained_var": -0.3529871329665184, "kl": 0.007054349011741579, "entropy": 1.601633110642433, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1640.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4723248600959777, "cur_kl_coeff": 1.9073486328124998e-07, "cur_lr": 2e-05, "total_loss": -0.014172097784467041, "policy_loss": -0.0029727017506957056, "vf_loss": 0.5956967901438475, "vf_explained_var": -0.974629744887352, "kl": 0.004909685894381255, "entropy": 1.601235891878605, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1640.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7693710334599018, "cur_kl_coeff": 2.4414062499999998e-05, "cur_lr": 2e-05, "total_loss": 0.0144088861416094, "policy_loss": -0.002893550880253315, "vf_loss": 0.711410304531455, "vf_explained_var": -0.10441276356577874, "kl": 0.0041674873617012055, "entropy": 1.6055023938417434, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1640.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.312264034152031, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": 0.17697307161288336, "policy_loss": 0.0038104982813820243, "vf_loss": 1.33163775652647, "vf_explained_var": -0.7787066891789436, "kl": 0.005972290615318343, "entropy": 1.5975152805447579, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1640.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5466786973178386, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.042835282711894254, "policy_loss": -0.014252027147449553, "vf_loss": 0.5184711873531341, "vf_explained_var": -0.4850592270493507, "kl": 0.007797137531451881, "entropy": 1.5976047560572624, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1640.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.794164204597473, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 2e-05, "total_loss": 0.06513713811000343, "policy_loss": -0.001030679198447615, "vf_loss": 0.9071215584874153, "vf_explained_var": -0.25213191136717794, "kl": 0.004813477909192443, "entropy": 1.6062761098146439, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1640.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6603881791234016, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 2e-05, "total_loss": 0.06997992178876303, "policy_loss": -0.0042555582709610466, "vf_loss": 0.9362144198268652, "vf_explained_var": -0.3778972990810871, "kl": 0.007508431538008153, "entropy": 1.598210571706295, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1640.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 86016}, "sampler_results": {"episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.78406249999944, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.8480078125, "pursuer_1": -45.8480078125, "pursuer_2": -45.8480078125, "pursuer_3": -45.8480078125, "pursuer_4": -45.8480078125, "pursuer_5": -45.8480078125, "pursuer_6": -45.8480078125, "pursuer_7": -45.8480078125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204, -374.6200000000009, -376.6025000000013, -348.4362500000003, -375.8099999999997], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4515221088698236, "mean_inference_ms": 15.584784842924872, "mean_action_processing_ms": 1.0134432244672937, "mean_env_wait_ms": 10.535290373251263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009785294532775879, "StateBufferConnector_ms": 0.004417002201080322, "ViewRequirementAgentConnector_ms": 0.1139231026172638}}, "episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.78406249999944, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.8480078125, "pursuer_1": -45.8480078125, "pursuer_2": -45.8480078125, "pursuer_3": -45.8480078125, "pursuer_4": -45.8480078125, "pursuer_5": -45.8480078125, "pursuer_6": -45.8480078125, "pursuer_7": -45.8480078125}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204, -374.6200000000009, -376.6025000000013, -348.4362500000003, -375.8099999999997], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4515221088698236, "mean_inference_ms": 15.584784842924872, "mean_action_processing_ms": 1.0134432244672937, "mean_env_wait_ms": 10.535290373251263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009785294532775879, "StateBufferConnector_ms": 0.004417002201080322, "ViewRequirementAgentConnector_ms": 0.1139231026172638}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 86016, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 39.50529116467507, "num_env_steps_trained_throughput_per_sec": 39.50529116467507, "timesteps_total": 10752, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 86016, "timers": {"training_iteration_time_ms": 12807.399, "sample_time_ms": 3867.315, "learn_time_ms": 8920.711, "learn_throughput": 57.395, "synch_weights_time_ms": 17.964}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 86016}, "done": false, "episodes_total": 20, "training_iteration": 21, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-14-13", "timestamp": 1708024453, "time_this_iter_s": 12.969574689865112, "time_total_s": 267.4501984119415, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f8588659480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 267.4501984119415, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 18.336842105263155, "ram_util_percent": 48.794736842105266}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.059614595770836, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": 0.05077707411837764, "policy_loss": -0.0008236633264459669, "vf_loss": 0.844369388371706, "vf_explained_var": -0.21072207912802696, "kl": 0.015936981560662387, "entropy": 1.5950405567884445, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1720.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9692984208464623, "cur_kl_coeff": 4.8828124999999996e-05, "cur_lr": 2e-05, "total_loss": 0.23963488565641455, "policy_loss": -0.004167294281069189, "vf_loss": 1.615147551894188, "vf_explained_var": -0.9793662577867508, "kl": 0.005626635352382436, "entropy": 1.5998498752713204, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1720.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6374581575393676, "cur_kl_coeff": 9.536743164062499e-08, "cur_lr": 2e-05, "total_loss": 0.003205478610470891, "policy_loss": -0.004382221191190183, "vf_loss": 0.6693545754998922, "vf_explained_var": 0.32306131049990655, "kl": 0.004686693858820945, "entropy": 1.5975094079971313, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1720.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5111405365169048, "cur_kl_coeff": 1.2207031249999999e-05, "cur_lr": 2e-05, "total_loss": 0.3799354075919837, "policy_loss": -0.002321756328456104, "vf_loss": 2.1705132231116293, "vf_explained_var": -0.9414933741092681, "kl": 0.004350608075037598, "entropy": 1.6037118926644325, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1720.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.904477297514677, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": 0.012806843612634112, "policy_loss": -0.01946292428765446, "vf_loss": 0.7660689271986485, "vf_explained_var": -0.049515438824892045, "kl": 0.009267244662623852, "entropy": 1.5925470069050789, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1720.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6122452914714813, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": 0.4160704919835553, "policy_loss": -0.002716308971866965, "vf_loss": 2.300177477300167, "vf_explained_var": -0.6862075619399548, "kl": 0.015862941229715943, "entropy": 1.5943015187978744, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1720.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2637381859123706, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 2e-05, "total_loss": -0.00024816371224005706, "policy_loss": -0.009933861147146672, "vf_loss": 0.6810684904456139, "vf_explained_var": -0.07189572528004647, "kl": 0.006190593319479376, "entropy": 1.6059109702706338, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1720.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.400692863762379, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 2e-05, "total_loss": 0.30604888326488433, "policy_loss": -0.007933501829393208, "vf_loss": 1.8887729227542878, "vf_explained_var": -0.9372721508145332, "kl": 0.00984329906059429, "entropy": 1.5821468874812126, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1720.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 90112}, "sampler_results": {"episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.78406249999944, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.8480078125, "pursuer_1": -45.8480078125, "pursuer_2": -45.8480078125, "pursuer_3": -45.8480078125, "pursuer_4": -45.8480078125, "pursuer_5": -45.8480078125, "pursuer_6": -45.8480078125, "pursuer_7": -45.8480078125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204, -374.6200000000009, -376.6025000000013, -348.4362500000003, -375.8099999999997], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4515221088698236, "mean_inference_ms": 15.584784842924872, "mean_action_processing_ms": 1.0134432244672937, "mean_env_wait_ms": 10.535290373251263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009785294532775879, "StateBufferConnector_ms": 0.004417002201080322, "ViewRequirementAgentConnector_ms": 0.1139231026172638}}, "episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.78406249999944, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.8480078125, "pursuer_1": -45.8480078125, "pursuer_2": -45.8480078125, "pursuer_3": -45.8480078125, "pursuer_4": -45.8480078125, "pursuer_5": -45.8480078125, "pursuer_6": -45.8480078125, "pursuer_7": -45.8480078125}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204, -374.6200000000009, -376.6025000000013, -348.4362500000003, -375.8099999999997], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4515221088698236, "mean_inference_ms": 15.584784842924872, "mean_action_processing_ms": 1.0134432244672937, "mean_env_wait_ms": 10.535290373251263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009785294532775879, "StateBufferConnector_ms": 0.004417002201080322, "ViewRequirementAgentConnector_ms": 0.1139231026172638}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 90112, "num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 39.27998584702525, "num_env_steps_trained_throughput_per_sec": 39.27998584702525, "timesteps_total": 11264, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 90112, "timers": {"training_iteration_time_ms": 12896.509, "sample_time_ms": 3884.877, "learn_time_ms": 8992.769, "learn_throughput": 56.935, "synch_weights_time_ms": 17.451}, "counters": {"num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 90112}, "done": false, "episodes_total": 20, "training_iteration": 22, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-14-26", "timestamp": 1708024466, "time_this_iter_s": 13.045675277709961, "time_total_s": 280.4958736896515, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f8588643eb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 280.4958736896515, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.663157894736845, "ram_util_percent": 48.7421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9977555830031634, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": -0.07421377193531953, "policy_loss": 0.003828361164778471, "vf_loss": 0.3275229446589947, "vf_explained_var": 0.0018386274576187133, "kl": 0.013000788679346443, "entropy": 1.5993302196264267, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1800.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.107411339133978, "cur_kl_coeff": 4.8828124999999996e-05, "cur_lr": 2e-05, "total_loss": -0.04523088264541002, "policy_loss": 0.006554722506552935, "vf_loss": 0.4343346798792481, "vf_explained_var": 0.2041317604482174, "kl": 0.005090320511953905, "entropy": 1.6036952227354049, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1800.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6553327210247517, "cur_kl_coeff": 4.7683715820312496e-08, "cur_lr": 2e-05, "total_loss": 0.4835051832720637, "policy_loss": -0.0026819461025297643, "vf_loss": 2.5858079895377157, "vf_explained_var": -0.9993595227599144, "kl": 0.00447898666607216, "entropy": 1.6026486545801162, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1800.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.331038970500231, "cur_kl_coeff": 6.1035156249999995e-06, "cur_lr": 2e-05, "total_loss": 0.1315805372025352, "policy_loss": -0.008147353096865118, "vf_loss": 1.2016064368188382, "vf_explained_var": -0.9767154917120934, "kl": 0.005574724928010255, "entropy": 1.60673745572567, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1800.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4676916271448135, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": 0.05794332862715237, "policy_loss": 0.0010333910468034446, "vf_loss": 0.8665008798241616, "vf_explained_var": -0.5788274243474006, "kl": 0.011733266606461257, "entropy": 1.597244466841221, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1800.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.264637553691864, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.07524754815967753, "policy_loss": 0.004459430882707238, "vf_loss": 0.3095836969092488, "vf_explained_var": -0.13131793811917306, "kl": 0.0077193280216306445, "entropy": 1.5864676892757417, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1800.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9812791153788567, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 2e-05, "total_loss": 0.1332460647514381, "policy_loss": 0.00595373238902539, "vf_loss": 1.1520024932920934, "vf_explained_var": -0.9978396013379097, "kl": 0.004738699714653194, "entropy": 1.607156927883625, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1800.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6906831450760365, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 2e-05, "total_loss": 0.008752732103130257, "policy_loss": -0.0009357636445201933, "vf_loss": 0.6753128085285425, "vf_explained_var": -0.6457274399697781, "kl": 0.007263854128541425, "entropy": 1.5914254039525986, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1800.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_agent_steps_sampled": 94208, "num_agent_steps_trained": 94208}, "sampler_results": {"episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.78406249999944, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.8480078125, "pursuer_1": -45.8480078125, "pursuer_2": -45.8480078125, "pursuer_3": -45.8480078125, "pursuer_4": -45.8480078125, "pursuer_5": -45.8480078125, "pursuer_6": -45.8480078125, "pursuer_7": -45.8480078125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204, -374.6200000000009, -376.6025000000013, -348.4362500000003, -375.8099999999997], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4515221088698236, "mean_inference_ms": 15.584784842924872, "mean_action_processing_ms": 1.0134432244672937, "mean_env_wait_ms": 10.535290373251263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009785294532775879, "StateBufferConnector_ms": 0.004417002201080322, "ViewRequirementAgentConnector_ms": 0.1139231026172638}}, "episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.78406249999944, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.8480078125, "pursuer_1": -45.8480078125, "pursuer_2": -45.8480078125, "pursuer_3": -45.8480078125, "pursuer_4": -45.8480078125, "pursuer_5": -45.8480078125, "pursuer_6": -45.8480078125, "pursuer_7": -45.8480078125}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204, -374.6200000000009, -376.6025000000013, -348.4362500000003, -375.8099999999997], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4515221088698236, "mean_inference_ms": 15.584784842924872, "mean_action_processing_ms": 1.0134432244672937, "mean_env_wait_ms": 10.535290373251263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009785294532775879, "StateBufferConnector_ms": 0.004417002201080322, "ViewRequirementAgentConnector_ms": 0.1139231026172638}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94208, "num_agent_steps_trained": 94208, "num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 32.99224568012223, "num_env_steps_trained_throughput_per_sec": 32.99224568012223, "timesteps_total": 11776, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 94208, "timers": {"training_iteration_time_ms": 13253.805, "sample_time_ms": 3900.261, "learn_time_ms": 9334.629, "learn_throughput": 54.85, "synch_weights_time_ms": 17.513}, "counters": {"num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_agent_steps_sampled": 94208, "num_agent_steps_trained": 94208}, "done": false, "episodes_total": 20, "training_iteration": 23, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-14-42", "timestamp": 1708024482, "time_this_iter_s": 15.527637243270874, "time_total_s": 296.02351093292236, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f8588614ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 296.02351093292236, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 16.886363636363637, "ram_util_percent": 48.84090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3731591507792473, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": 0.0024765652873611544, "policy_loss": 0.009651040192693472, "vf_loss": 0.6085938401520252, "vf_explained_var": -0.6760309204459191, "kl": 0.009776662685908377, "entropy": 1.5933056786656379, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1880.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1348971001803876, "cur_kl_coeff": 4.8828124999999996e-05, "cur_lr": 2e-05, "total_loss": -0.056286742741576745, "policy_loss": -0.0054116353392601015, "vf_loss": 0.43662289194762705, "vf_explained_var": -0.16165047585964204, "kl": 0.006385806977050379, "entropy": 1.6003113970160485, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1880.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5744478210806847, "cur_kl_coeff": 2.3841857910156248e-08, "cur_lr": 2e-05, "total_loss": 0.1602232530261972, "policy_loss": -0.002740750112570822, "vf_loss": 1.293808899819851, "vf_explained_var": -0.834060724079609, "kl": 0.003934376643155701, "entropy": 1.6048821613192559, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1880.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.630171750485897, "cur_kl_coeff": 6.1035156249999995e-06, "cur_lr": 2e-05, "total_loss": 0.12080007141303213, "policy_loss": -0.008875594101846218, "vf_loss": 1.1606716081500053, "vf_explained_var": -0.8899952664971351, "kl": 0.006045170925790444, "entropy": 1.604922665655613, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1880.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3850548677146435, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": -0.02630658261186909, "policy_loss": -0.0023063735803589224, "vf_loss": 0.544029051810503, "vf_explained_var": 0.22432492896914483, "kl": 0.00538514600484632, "entropy": 1.600116741657257, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1880.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4924500972032546, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": 0.05379771417065058, "policy_loss": -0.0008129818248562515, "vf_loss": 0.845250828564167, "vf_explained_var": -0.17129149436950683, "kl": 0.009962807124247774, "entropy": 1.5869457110762597, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1880.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9515190601348877, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": 0.06904331523401197, "policy_loss": 0.000701064127497375, "vf_loss": 0.915039662271738, "vf_explained_var": -0.03076188713312149, "kl": 0.00454837832658086, "entropy": 1.6042121261358262, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1880.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1923604242503643, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 2e-05, "total_loss": 0.03843763478598703, "policy_loss": 0.0019794580060988665, "vf_loss": 0.7794452242553234, "vf_explained_var": -0.36262120455503466, "kl": 0.012505097023677081, "entropy": 1.5840801134705544, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1880.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 98304}, "sampler_results": {"episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.16963541666655, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.77120442708334, "pursuer_1": -45.77120442708334, "pursuer_2": -45.77120442708334, "pursuer_3": -45.77120442708334, "pursuer_4": -45.77120442708334, "pursuer_5": -45.77120442708334, "pursuer_6": -45.77120442708334, "pursuer_7": -45.77120442708334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204, -374.6200000000009, -376.6025000000013, -348.4362500000003, -375.8099999999997, -377.0912500000044, -349.9362500000035, -350.19000000000153, -375.17249999999837], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.451745643705065, "mean_inference_ms": 15.585618041091728, "mean_action_processing_ms": 1.0127465250441663, "mean_env_wait_ms": 10.53186391394618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009721517562866211, "StateBufferConnector_ms": 0.0044313569863637286, "ViewRequirementAgentConnector_ms": 0.11480910082658131}}, "episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.16963541666655, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.77120442708334, "pursuer_1": -45.77120442708334, "pursuer_2": -45.77120442708334, "pursuer_3": -45.77120442708334, "pursuer_4": -45.77120442708334, "pursuer_5": -45.77120442708334, "pursuer_6": -45.77120442708334, "pursuer_7": -45.77120442708334}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204, -374.6200000000009, -376.6025000000013, -348.4362500000003, -375.8099999999997, -377.0912500000044, -349.9362500000035, -350.19000000000153, -375.17249999999837], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.451745643705065, "mean_inference_ms": 15.585618041091728, "mean_action_processing_ms": 1.0127465250441663, "mean_env_wait_ms": 10.53186391394618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009721517562866211, "StateBufferConnector_ms": 0.0044313569863637286, "ViewRequirementAgentConnector_ms": 0.11480910082658131}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 98304, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 35.89543045768602, "num_env_steps_trained_throughput_per_sec": 35.89543045768602, "timesteps_total": 12288, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 98304, "timers": {"training_iteration_time_ms": 13465.17, "sample_time_ms": 3920.658, "learn_time_ms": 9525.981, "learn_throughput": 53.748, "synch_weights_time_ms": 17.131}, "counters": {"num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 98304}, "done": false, "episodes_total": 24, "training_iteration": 24, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-14-56", "timestamp": 1708024496, "time_this_iter_s": 14.274085521697998, "time_total_s": 310.29759645462036, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f85886417e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 310.29759645462036, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 19.260000000000005, "ram_util_percent": 48.65500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9487638652324677, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": 0.057439577984041534, "policy_loss": -0.014324481785297393, "vf_loss": 0.9255668062716722, "vf_explained_var": -0.9164462938904763, "kl": 0.019175569934304804, "entropy": 1.596426174044609, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1960.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.628240342438221, "cur_kl_coeff": 4.8828124999999996e-05, "cur_lr": 2e-05, "total_loss": 0.08126903116644826, "policy_loss": -0.0016693056328222155, "vf_loss": 0.9740919828414917, "vf_explained_var": -0.36911407858133316, "kl": 0.005009212234290317, "entropy": 1.6058490350842476, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1960.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7866344034671784, "cur_kl_coeff": 1.1920928955078124e-08, "cur_lr": 2e-05, "total_loss": 0.0593486787067377, "policy_loss": 0.0060696535976603625, "vf_loss": 0.8547272674739361, "vf_explained_var": -0.2790296897292137, "kl": 0.005599734402494505, "entropy": 1.604027883708477, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1960.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8726569317281245, "cur_kl_coeff": 6.1035156249999995e-06, "cur_lr": 2e-05, "total_loss": -0.004382011471898295, "policy_loss": -0.0001163058215752244, "vf_loss": 0.6249376516789198, "vf_explained_var": -0.7015289157629013, "kl": 0.008683514618314802, "entropy": 1.6050016671419143, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1960.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.99593003988266, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": 0.0488766504713567, "policy_loss": -0.0028624158585444093, "vf_loss": 0.8488823488354683, "vf_explained_var": 0.07836369201540946, "kl": 0.0067384387366473675, "entropy": 1.6048678502440452, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1960.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3392428152263165, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.028932214151427615, "policy_loss": -0.0012367095565423369, "vf_loss": 0.5201675511896611, "vf_explained_var": 0.2564404770731926, "kl": 0.007977924117585643, "entropy": 1.593329718708992, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1960.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9941481418907643, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 2e-05, "total_loss": 0.11920152734746807, "policy_loss": -0.007889558002352715, "vf_loss": 1.1508072823286057, "vf_explained_var": -0.24628819301724433, "kl": 0.005792682600440457, "entropy": 1.6061299562454223, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1960.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9746916055679322, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 2e-05, "total_loss": 0.044862251220911274, "policy_loss": -0.00019258462125435472, "vf_loss": 0.814697652682662, "vf_explained_var": -0.23005377352237702, "kl": 0.012401777249760926, "entropy": 1.5862441763281823, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1960.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 102400, "num_agent_steps_trained": 102400}, "sampler_results": {"episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.16963541666655, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.77120442708334, "pursuer_1": -45.77120442708334, "pursuer_2": -45.77120442708334, "pursuer_3": -45.77120442708334, "pursuer_4": -45.77120442708334, "pursuer_5": -45.77120442708334, "pursuer_6": -45.77120442708334, "pursuer_7": -45.77120442708334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204, -374.6200000000009, -376.6025000000013, -348.4362500000003, -375.8099999999997, -377.0912500000044, -349.9362500000035, -350.19000000000153, -375.17249999999837], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.451745643705065, "mean_inference_ms": 15.585618041091728, "mean_action_processing_ms": 1.0127465250441663, "mean_env_wait_ms": 10.53186391394618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009721517562866211, "StateBufferConnector_ms": 0.0044313569863637286, "ViewRequirementAgentConnector_ms": 0.11480910082658131}}, "episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.16963541666655, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.77120442708334, "pursuer_1": -45.77120442708334, "pursuer_2": -45.77120442708334, "pursuer_3": -45.77120442708334, "pursuer_4": -45.77120442708334, "pursuer_5": -45.77120442708334, "pursuer_6": -45.77120442708334, "pursuer_7": -45.77120442708334}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204, -374.6200000000009, -376.6025000000013, -348.4362500000003, -375.8099999999997, -377.0912500000044, -349.9362500000035, -350.19000000000153, -375.17249999999837], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.451745643705065, "mean_inference_ms": 15.585618041091728, "mean_action_processing_ms": 1.0127465250441663, "mean_env_wait_ms": 10.53186391394618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009721517562866211, "StateBufferConnector_ms": 0.0044313569863637286, "ViewRequirementAgentConnector_ms": 0.11480910082658131}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102400, "num_agent_steps_trained": 102400, "num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 38.121186995760254, "num_env_steps_trained_throughput_per_sec": 38.121186995760254, "timesteps_total": 12800, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 102400, "timers": {"training_iteration_time_ms": 13177.78, "sample_time_ms": 3966.833, "learn_time_ms": 9192.48, "learn_throughput": 55.698, "synch_weights_time_ms": 17.055}, "counters": {"num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 102400, "num_agent_steps_trained": 102400}, "done": false, "episodes_total": 24, "training_iteration": 25, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-15-09", "timestamp": 1708024509, "time_this_iter_s": 13.441616535186768, "time_total_s": 323.73921298980713, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f8588615a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 323.73921298980713, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 20.25263157894737, "ram_util_percent": 48.7578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.455377609282732, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": -0.013310470375290605, "policy_loss": 0.012164870300330222, "vf_loss": 0.5346494499593973, "vf_explained_var": -0.7338615030050277, "kl": 0.02330142438877374, "entropy": 1.5915590450167656, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2040.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5076141625642776, "cur_kl_coeff": 4.8828124999999996e-05, "cur_lr": 2e-05, "total_loss": 0.0007847714587114751, "policy_loss": -0.006758522475138307, "vf_loss": 0.670728026330471, "vf_explained_var": -0.6436214953660965, "kl": 0.007367176847765222, "entropy": 1.601390679180622, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2040.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0518801800906656, "cur_kl_coeff": 1.1920928955078124e-08, "cur_lr": 2e-05, "total_loss": 0.12706517851911486, "policy_loss": -0.0010269122431054711, "vf_loss": 1.1549406312406063, "vf_explained_var": -0.6842512406408787, "kl": 0.005062924470985308, "entropy": 1.606430646777153, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2040.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6367915853857995, "cur_kl_coeff": 6.1035156249999995e-06, "cur_lr": 2e-05, "total_loss": 0.03128326704027131, "policy_loss": -0.00922826207242906, "vf_loss": 0.8037117663770914, "vf_explained_var": -0.5984470061957836, "kl": 0.008627702860394493, "entropy": 1.6041646003723145, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2040.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9125127486884594, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": 0.04744927119099884, "policy_loss": -0.011127842590212822, "vf_loss": 0.8736772656440734, "vf_explained_var": -0.27597556784749033, "kl": 0.0075448752497322856, "entropy": 1.5984809026122093, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2040.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8384391866624354, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.04907507010502741, "policy_loss": -0.015783787053078414, "vf_loss": 0.4972142830491066, "vf_explained_var": 0.32507849484682083, "kl": 0.009615778212901206, "entropy": 1.5951800793409348, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2040.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.130851885676384, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 2e-05, "total_loss": 0.23555134523194282, "policy_loss": -0.003580320067703724, "vf_loss": 1.5976909756660462, "vf_explained_var": -0.9960435643792153, "kl": 0.00920246381429024, "entropy": 1.6029466480016707, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2040.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.430310708284378, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 2e-05, "total_loss": -0.00849886987125501, "policy_loss": 0.0042483538389205934, "vf_loss": 0.5873641476035119, "vf_explained_var": -0.4364887848496437, "kl": 0.009242628747597337, "entropy": 1.5959186926484108, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2040.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 106496, "num_agent_steps_trained": 106496}, "sampler_results": {"episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.16963541666655, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.77120442708334, "pursuer_1": -45.77120442708334, "pursuer_2": -45.77120442708334, "pursuer_3": -45.77120442708334, "pursuer_4": -45.77120442708334, "pursuer_5": -45.77120442708334, "pursuer_6": -45.77120442708334, "pursuer_7": -45.77120442708334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204, -374.6200000000009, -376.6025000000013, -348.4362500000003, -375.8099999999997, -377.0912500000044, -349.9362500000035, -350.19000000000153, -375.17249999999837], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.451745643705065, "mean_inference_ms": 15.585618041091728, "mean_action_processing_ms": 1.0127465250441663, "mean_env_wait_ms": 10.53186391394618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009721517562866211, "StateBufferConnector_ms": 0.0044313569863637286, "ViewRequirementAgentConnector_ms": 0.11480910082658131}}, "episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.16963541666655, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.77120442708334, "pursuer_1": -45.77120442708334, "pursuer_2": -45.77120442708334, "pursuer_3": -45.77120442708334, "pursuer_4": -45.77120442708334, "pursuer_5": -45.77120442708334, "pursuer_6": -45.77120442708334, "pursuer_7": -45.77120442708334}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204, -374.6200000000009, -376.6025000000013, -348.4362500000003, -375.8099999999997, -377.0912500000044, -349.9362500000035, -350.19000000000153, -375.17249999999837], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.451745643705065, "mean_inference_ms": 15.585618041091728, "mean_action_processing_ms": 1.0127465250441663, "mean_env_wait_ms": 10.53186391394618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009721517562866211, "StateBufferConnector_ms": 0.0044313569863637286, "ViewRequirementAgentConnector_ms": 0.11480910082658131}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 106496, "num_agent_steps_trained": 106496, "num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 41.514068321135866, "num_env_steps_trained_throughput_per_sec": 41.514068321135866, "timesteps_total": 13312, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 106496, "timers": {"training_iteration_time_ms": 13157.367, "sample_time_ms": 3963.344, "learn_time_ms": 9175.54, "learn_throughput": 55.801, "synch_weights_time_ms": 17.057}, "counters": {"num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 106496, "num_agent_steps_trained": 106496}, "done": false, "episodes_total": 24, "training_iteration": 26, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-15-22", "timestamp": 1708024522, "time_this_iter_s": 12.342598915100098, "time_total_s": 336.0818119049072, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f8588643f40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 336.0818119049072, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 18.02777777777778, "ram_util_percent": 48.7388888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3821085937321187, "cur_kl_coeff": 0.001171875, "cur_lr": 2e-05, "total_loss": -0.09262429178124876, "policy_loss": -0.009785317350178957, "vf_loss": 0.30986426044255494, "vf_explained_var": -0.2668787620961666, "kl": 0.013141622114926577, "entropy": 1.603204384446144, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2120.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0088802758604287, "cur_kl_coeff": 4.8828124999999996e-05, "cur_lr": 2e-05, "total_loss": -0.07751237815245986, "policy_loss": -0.001155621698126197, "vf_loss": 0.33512172028422355, "vf_explained_var": 0.0777266263961792, "kl": 0.007952043262775987, "entropy": 1.6013757482171058, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2120.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4134662240743636, "cur_kl_coeff": 1.1920928955078124e-08, "cur_lr": 2e-05, "total_loss": 0.21032083078753203, "policy_loss": 0.0003972170641645789, "vf_loss": 1.481650274991989, "vf_explained_var": -0.6959249764680863, "kl": 0.0069039217720273886, "entropy": 1.6048894584178925, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2120.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.491722645610571, "cur_kl_coeff": 6.1035156249999995e-06, "cur_lr": 2e-05, "total_loss": -0.051284926278458445, "policy_loss": -0.005881082359701395, "vf_loss": 0.45943836495280266, "vf_explained_var": -0.34970844388008115, "kl": 0.011690517608076333, "entropy": 1.6026350110769272, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2120.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2597411274909973, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": -0.04461639366782037, "policy_loss": -0.010080791264772414, "vf_loss": 0.49788587018847463, "vf_explained_var": 0.36730242893099785, "kl": 0.013293874287046491, "entropy": 1.590174525976181, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2120.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2403430327773095, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": -0.04612986743159127, "policy_loss": 0.00014623787137679756, "vf_loss": 0.44244353100657463, "vf_explained_var": 0.13055847510695456, "kl": 0.010711462912149727, "entropy": 1.5902927830815314, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2120.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.59655157327652, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 2e-05, "total_loss": 0.2905102409538813, "policy_loss": -0.0077792568365111945, "vf_loss": 1.8353646770119667, "vf_explained_var": -0.9787080243229866, "kl": 0.005379149992950261, "entropy": 1.6055377155542374, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2120.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4509554006159306, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 2e-05, "total_loss": -0.051213963021928065, "policy_loss": 0.0067050499375909565, "vf_loss": 0.4048731246963143, "vf_explained_var": -0.4126247622072697, "kl": 0.010025940585182979, "entropy": 1.591412054002285, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2120.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_agent_steps_sampled": 110592, "num_agent_steps_trained": 110592}, "sampler_results": {"episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.16963541666655, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.77120442708334, "pursuer_1": -45.77120442708334, "pursuer_2": -45.77120442708334, "pursuer_3": -45.77120442708334, "pursuer_4": -45.77120442708334, "pursuer_5": -45.77120442708334, "pursuer_6": -45.77120442708334, "pursuer_7": -45.77120442708334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204, -374.6200000000009, -376.6025000000013, -348.4362500000003, -375.8099999999997, -377.0912500000044, -349.9362500000035, -350.19000000000153, -375.17249999999837], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.451745643705065, "mean_inference_ms": 15.585618041091728, "mean_action_processing_ms": 1.0127465250441663, "mean_env_wait_ms": 10.53186391394618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009721517562866211, "StateBufferConnector_ms": 0.0044313569863637286, "ViewRequirementAgentConnector_ms": 0.11480910082658131}}, "episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.16963541666655, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.77120442708334, "pursuer_1": -45.77120442708334, "pursuer_2": -45.77120442708334, "pursuer_3": -45.77120442708334, "pursuer_4": -45.77120442708334, "pursuer_5": -45.77120442708334, "pursuer_6": -45.77120442708334, "pursuer_7": -45.77120442708334}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204, -374.6200000000009, -376.6025000000013, -348.4362500000003, -375.8099999999997, -377.0912500000044, -349.9362500000035, -350.19000000000153, -375.17249999999837], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.451745643705065, "mean_inference_ms": 15.585618041091728, "mean_action_processing_ms": 1.0127465250441663, "mean_env_wait_ms": 10.53186391394618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009721517562866211, "StateBufferConnector_ms": 0.0044313569863637286, "ViewRequirementAgentConnector_ms": 0.11480910082658131}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110592, "num_agent_steps_trained": 110592, "num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 37.694435398881254, "num_env_steps_trained_throughput_per_sec": 37.694435398881254, "timesteps_total": 13824, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 110592, "timers": {"training_iteration_time_ms": 13254.18, "sample_time_ms": 3958.803, "learn_time_ms": 9277.0, "learn_throughput": 55.19, "synch_weights_time_ms": 16.944}, "counters": {"num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_agent_steps_sampled": 110592, "num_agent_steps_trained": 110592}, "done": false, "episodes_total": 24, "training_iteration": 27, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-15-36", "timestamp": 1708024536, "time_this_iter_s": 13.592503786087036, "time_total_s": 349.67431569099426, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f8588732290>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 349.67431569099426, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 17.170000000000005, "ram_util_percent": 48.83999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6088257551193237, "cur_kl_coeff": 0.001171875, "cur_lr": 2e-05, "total_loss": 0.023570984249818138, "policy_loss": -0.00025831013917922976, "vf_loss": 0.7354530304670334, "vf_explained_var": -0.0719267636537552, "kl": 0.015232850180473179, "entropy": 1.6005181148648262, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2200.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.720460719615221, "cur_kl_coeff": 4.8828124999999996e-05, "cur_lr": 2e-05, "total_loss": 0.02537753017968498, "policy_loss": -0.007365482184104622, "vf_loss": 0.7731207109987736, "vf_explained_var": -0.6028155766427516, "kl": 0.006170818884856999, "entropy": 1.605374638736248, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2200.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7618261978030203, "cur_kl_coeff": 1.1920928955078124e-08, "cur_lr": 2e-05, "total_loss": 0.22657711408101022, "policy_loss": -0.011587258661165833, "vf_loss": 1.593008503317833, "vf_explained_var": -0.1560414344072342, "kl": 0.006035278562922031, "entropy": 1.6008775651454925, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2200.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.592428098618984, "cur_kl_coeff": 6.1035156249999995e-06, "cur_lr": 2e-05, "total_loss": 0.5327286189422011, "policy_loss": -0.011537804792169482, "vf_loss": 2.8163189008831977, "vf_explained_var": -1.0, "kl": 0.007837838982231915, "entropy": 1.598133571445942, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2200.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5711318150162696, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": 0.031030118628405035, "policy_loss": 0.00808054197113961, "vf_loss": 0.7304381333291531, "vf_explained_var": -0.4719359003007412, "kl": 0.011093560932204127, "entropy": 1.5966862246394158, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2200.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.761916570365429, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": 0.16570350786205382, "policy_loss": 0.005162069527432323, "vf_loss": 1.272382951527834, "vf_explained_var": -0.6554664529860019, "kl": 0.010286726616322994, "entropy": 1.5961164072155953, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2200.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7476589411497117, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 2e-05, "total_loss": 0.27583932178094983, "policy_loss": 0.008682299696374685, "vf_loss": 1.7105242937803269, "vf_explained_var": -0.5906511172652245, "kl": 0.004645248281303793, "entropy": 1.6047585651278495, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2200.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1543330818414688, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 2e-05, "total_loss": -0.03719730795783107, "policy_loss": -0.010819213080685586, "vf_loss": 0.5277725700289011, "vf_explained_var": -0.16018312945961952, "kl": 0.011870539642404764, "entropy": 1.5832587093114854, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2200.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 114688, "num_agent_steps_trained": 114688}, "sampler_results": {"episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.6241517857142, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.82801897321429, "pursuer_1": -45.82801897321429, "pursuer_2": -45.82801897321429, "pursuer_3": -45.82801897321429, "pursuer_4": -45.82801897321429, "pursuer_5": -45.82801897321429, "pursuer_6": -45.82801897321429, "pursuer_7": -45.82801897321429}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204, -374.6200000000009, -376.6025000000013, -348.4362500000003, -375.8099999999997, -377.0912500000044, -349.9362500000035, -350.19000000000153, -375.17249999999837, -360.15500000000105, -376.32749999999805, -364.58250000000385, -376.3399999999991], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.45320617369918, "mean_inference_ms": 15.590064673184552, "mean_action_processing_ms": 1.0121212595515243, "mean_env_wait_ms": 10.531247955522918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009843600647790092, "StateBufferConnector_ms": 0.004454276391438076, "ViewRequirementAgentConnector_ms": 0.11581342135156904}}, "episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.6241517857142, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.82801897321429, "pursuer_1": -45.82801897321429, "pursuer_2": -45.82801897321429, "pursuer_3": -45.82801897321429, "pursuer_4": -45.82801897321429, "pursuer_5": -45.82801897321429, "pursuer_6": -45.82801897321429, "pursuer_7": -45.82801897321429}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204, -374.6200000000009, -376.6025000000013, -348.4362500000003, -375.8099999999997, -377.0912500000044, -349.9362500000035, -350.19000000000153, -375.17249999999837, -360.15500000000105, -376.32749999999805, -364.58250000000385, -376.3399999999991], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.45320617369918, "mean_inference_ms": 15.590064673184552, "mean_action_processing_ms": 1.0121212595515243, "mean_env_wait_ms": 10.531247955522918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009843600647790092, "StateBufferConnector_ms": 0.004454276391438076, "ViewRequirementAgentConnector_ms": 0.11581342135156904}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 114688, "num_agent_steps_trained": 114688, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 37.719039476072496, "num_env_steps_trained_throughput_per_sec": 37.719039476072496, "timesteps_total": 14336, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 114688, "timers": {"training_iteration_time_ms": 13283.24, "sample_time_ms": 3950.243, "learn_time_ms": 9314.305, "learn_throughput": 54.969, "synch_weights_time_ms": 17.214}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 114688, "num_agent_steps_trained": 114688}, "done": false, "episodes_total": 28, "training_iteration": 28, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-15-49", "timestamp": 1708024549, "time_this_iter_s": 13.58763599395752, "time_total_s": 363.2619516849518, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f8588643400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 363.2619516849518, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 18.036842105263155, "ram_util_percent": 48.65789473684211}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"pursuer_6": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8456251360476017, "cur_kl_coeff": 0.001171875, "cur_lr": 2e-05, "total_loss": 0.04214473809806805, "policy_loss": -0.020676998817361892, "vf_loss": 0.8892404928803443, "vf_explained_var": -0.7898883804678917, "kl": 0.020909991837106644, "entropy": 1.595128870010376, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2280.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.371999855339527, "cur_kl_coeff": 4.8828124999999996e-05, "cur_lr": 2e-05, "total_loss": 0.17423809048486874, "policy_loss": -0.012262840114999563, "vf_loss": 1.3873373940587044, "vf_explained_var": -0.7523959591984749, "kl": 0.007443376287119463, "entropy": 1.603337812423706, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2280.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6950340919196605, "cur_kl_coeff": 1.1920928955078124e-08, "cur_lr": 2e-05, "total_loss": 0.17706403175834567, "policy_loss": -0.0007698079803958535, "vf_loss": 1.353095419704914, "vf_explained_var": -0.5164917685091496, "kl": 0.009136548032984138, "entropy": 1.604400099813938, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2280.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_5": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5193394225090742, "cur_kl_coeff": 6.1035156249999995e-06, "cur_lr": 2e-05, "total_loss": -0.06707371341763065, "policy_loss": 0.003104734746739268, "vf_loss": 0.36039817947894337, "vf_explained_var": 0.5132516853511333, "kl": 0.009978813352063298, "entropy": 1.6027804911136627, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2280.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_4": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7654203191399573, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 2e-05, "total_loss": 0.24043149535427802, "policy_loss": -0.003260319516994059, "vf_loss": 1.6144870229065418, "vf_explained_var": -0.6982616946101189, "kl": 0.009421770583139732, "entropy": 1.5993730068206786, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2280.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9771573565900327, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": 0.0505288245039992, "policy_loss": -0.00010879545006901026, "vf_loss": 0.825493435934186, "vf_explained_var": 0.047092369943857196, "kl": 0.014946148556191474, "entropy": 1.5872496277093888, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2280.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_7": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3392277151346206, "cur_kl_coeff": 0.00019531249999999998, "cur_lr": 2e-05, "total_loss": 0.15583099069772288, "policy_loss": 0.0036013362929224967, "vf_loss": 1.2508735366165638, "vf_explained_var": -0.5865011185407638, "kl": 0.005009260584483854, "entropy": 1.604897068440914, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2280.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}, "pursuer_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6695653364062308, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 2e-05, "total_loss": 0.047515870127244855, "policy_loss": 0.005004742206074298, "vf_loss": 0.8018296878784895, "vf_explained_var": -0.8841245546936989, "kl": 0.015268142521381377, "entropy": 1.579522532224655, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2280.5, "diff_num_grad_updates_vs_sampler_policy": 39.5}}, "num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_agent_steps_sampled": 118784, "num_agent_steps_trained": 118784}, "sampler_results": {"episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.6241517857142, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.82801897321429, "pursuer_1": -45.82801897321429, "pursuer_2": -45.82801897321429, "pursuer_3": -45.82801897321429, "pursuer_4": -45.82801897321429, "pursuer_5": -45.82801897321429, "pursuer_6": -45.82801897321429, "pursuer_7": -45.82801897321429}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204, -374.6200000000009, -376.6025000000013, -348.4362500000003, -375.8099999999997, -377.0912500000044, -349.9362500000035, -350.19000000000153, -375.17249999999837, -360.15500000000105, -376.32749999999805, -364.58250000000385, -376.3399999999991], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.45320617369918, "mean_inference_ms": 15.590064673184552, "mean_action_processing_ms": 1.0121212595515243, "mean_env_wait_ms": 10.531247955522918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009843600647790092, "StateBufferConnector_ms": 0.004454276391438076, "ViewRequirementAgentConnector_ms": 0.11581342135156904}}, "episode_reward_max": -342.4874999999977, "episode_reward_min": -377.81250000000006, "episode_reward_mean": -366.6241517857142, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"pursuer_0": -47.22656249999995, "pursuer_1": -47.22656249999995, "pursuer_2": -47.22656249999995, "pursuer_3": -47.22656249999995, "pursuer_4": -47.22656249999995, "pursuer_5": -47.22656249999995, "pursuer_6": -47.22656249999995, "pursuer_7": -47.22656249999995}, "policy_reward_max": {"pursuer_0": -42.810937500000044, "pursuer_1": -42.810937500000044, "pursuer_2": -42.810937500000044, "pursuer_3": -42.810937500000044, "pursuer_4": -42.810937500000044, "pursuer_5": -42.810937500000044, "pursuer_6": -42.810937500000044, "pursuer_7": -42.810937500000044}, "policy_reward_mean": {"pursuer_0": -45.82801897321429, "pursuer_1": -45.82801897321429, "pursuer_2": -45.82801897321429, "pursuer_3": -45.82801897321429, "pursuer_4": -45.82801897321429, "pursuer_5": -45.82801897321429, "pursuer_6": -45.82801897321429, "pursuer_7": -45.82801897321429}, "hist_stats": {"episode_reward": [-342.4874999999977, -376.7199999999975, -365.1199999999986, -362.8687499999987, -377.65750000000014, -376.4437499999973, -377.81250000000006, -369.3949999999988, -358.95624999999643, -361.28375000000153, -374.5262500000005, -372.31250000000193, -364.1325, -343.09249999999616, -376.6462499999987, -360.75750000000204, -374.6200000000009, -376.6025000000013, -348.4362500000003, -375.8099999999997, -377.0912500000044, -349.9362500000035, -350.19000000000153, -375.17249999999837, -360.15500000000105, -376.32749999999805, -364.58250000000385, -376.3399999999991], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_pursuer_0_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_1_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_2_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_3_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_4_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_5_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_6_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025], "policy_pursuer_7_reward": [-42.810937500000044, -47.09000000000001, -45.64000000000002, -45.35859375, -47.20718750000002, -47.05546875000002, -47.22656249999995, -46.174375000000005, -44.869531250000044, -45.16046874999995, -46.81578125000002, -46.53906249999995, -45.516562499999985, -42.88656250000002, -47.08078125, -45.094687499999964, -46.8275, -47.075312499999974, -43.55453124999998, -46.97625000000005, -47.13640625, -43.74203125, -43.77375000000003, -46.8965625, -45.01937499999999, -47.04093749999995, -45.57281249999997, -47.042500000000025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.45320617369918, "mean_inference_ms": 15.590064673184552, "mean_action_processing_ms": 1.0121212595515243, "mean_env_wait_ms": 10.531247955522918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009843600647790092, "StateBufferConnector_ms": 0.004454276391438076, "ViewRequirementAgentConnector_ms": 0.11581342135156904}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118784, "num_agent_steps_trained": 118784, "num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 37.45803182367914, "num_env_steps_trained_throughput_per_sec": 37.45803182367914, "timesteps_total": 14848, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 118784, "timers": {"training_iteration_time_ms": 13416.782, "sample_time_ms": 3945.438, "learn_time_ms": 9453.253, "learn_throughput": 54.161, "synch_weights_time_ms": 16.623}, "counters": {"num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_agent_steps_sampled": 118784, "num_agent_steps_trained": 118784}, "done": false, "episodes_total": 28, "training_iteration": 29, "trial_id": "c0ab6_00000", "date": "2024-02-15_14-16-03", "timestamp": 1708024563, "time_this_iter_s": 13.67914867401123, "time_total_s": 376.941100358963, "pid": 41935, "hostname": "ThinkPadKur", "node_ip": "172.23.148.251", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "pursuit_v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 2e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": ["pursuer_0", "pursuer_1", "pursuer_2", "pursuer_3", "pursuer_4", "pursuer_5", "pursuer_6", "pursuer_7"], "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x7f8588616440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 376.941100358963, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 18.189999999999998, "ram_util_percent": 48.80499999999999}}
